webpackJsonp([0],{

/***/ 100:
/* unknown exports provided */
/* all exports used */
/*!***************************************************************************!*\
  !*** ./django_comments_xtd/static/django_comments_xtd/js/src/comment.jsx ***!
  \***************************************************************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Comment = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _jquery = __webpack_require__(/*! jquery */ 37);\n\nvar _jquery2 = _interopRequireDefault(_jquery);\n\nvar _django = __webpack_require__(/*! django */ 58);\n\nvar _django2 = _interopRequireDefault(_django);\n\nvar _react = __webpack_require__(/*! react */ 19);\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = __webpack_require__(/*! react-dom */ 18);\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _remarkable = __webpack_require__(/*! remarkable */ 38);\n\nvar _remarkable2 = _interopRequireDefault(_remarkable);\n\nvar _commentform = __webpack_require__(/*! ./commentform.jsx */ 60);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Comment = exports.Comment = function (_React$Component) {\n  _inherits(Comment, _React$Component);\n\n  function Comment(props) {\n    _classCallCheck(this, Comment);\n\n    var _this = _possibleConstructorReturn(this, (Comment.__proto__ || Object.getPrototypeOf(Comment)).call(this, props));\n\n    _this.state = {\n      current_user: props.settings.current_user,\n      removal: props.data.flags.removal.active,\n      removal_count: props.data.flags.removal.count,\n      like: props.data.flags.like.active,\n      like_users: props.data.flags.like.users || [],\n      dislike: props.data.flags.dislike.active,\n      dislike_users: props.data.flags.dislike.users || [],\n      reply_form: {\n        component: null,\n        show: false\n      }\n    };\n    _this.action_like = _this.action_like.bind(_this);\n    _this.action_dislike = _this.action_dislike.bind(_this);\n    _this.handle_reply_click = _this.handle_reply_click.bind(_this);\n    return _this;\n  }\n\n  _createClass(Comment, [{\n    key: '_get_username_chunk',\n    value: function _get_username_chunk() {\n      var username = this.props.data.user_name,\n          moderator = \"\";\n\n      if (this.props.data.user_url && !this.props.data.is_removed) username = _react2.default.createElement(\n        'a',\n        { href: this.props.data.user_url },\n        username\n      );\n\n      if (this.props.data.user_moderator) {\n        var label = _django2.default.gettext(\"moderator\");\n        moderator = _react2.default.createElement(\n          'span',\n          null,\n          '\\xA0',\n          _react2.default.createElement(\n            'span',\n            { className: 'label label-default' },\n            label\n          )\n        );\n      }\n      return _react2.default.createElement(\n        'span',\n        null,\n        username,\n        moderator\n      );\n    }\n  }, {\n    key: '_get_right_div_chunk',\n    value: function _get_right_div_chunk() {\n      var flagging_html = \"\",\n          moderate_html = \"\",\n          url = \"\";\n\n      if (this.props.data.is_removed) return \"\";\n\n      if (this.props.settings.allow_flagging) {\n        var inappropriate_msg = \"\";\n        if (this.state.removal) {\n          inappropriate_msg = _django2.default.gettext(\"I flagged it as inappropriate\");\n          flagging_html = _react2.default.createElement('span', { className: 'glyphicon glyphicon-flag text-danger',\n            title: inappropriate_msg });\n        } else {\n          if (this.props.settings.is_authenticated) {\n            url = this.props.settings.flag_url.replace('0', this.props.data.id);\n          } else {\n            url = this.props.settings.login_url + \"?next=\" + this.props.settings.flag_url.replace('0', this.props.data.id);\n          }\n          inappropriate_msg = _django2.default.gettext(\"flag comment as inappropriate\");\n          flagging_html = _react2.default.createElement(\n            'a',\n            { className: 'mutedlink', href: url },\n            _react2.default.createElement('span', { className: 'glyphicon glyphicon-flag',\n              title: inappropriate_msg })\n          );\n        }\n      }\n\n      if (this.props.settings.is_authenticated && this.props.settings.can_moderate) {\n        var remove_msg = _django2.default.gettext(\"remove comment\");\n        url = this.props.settings.delete_url.replace('0', this.props.data.id);\n        moderate_html = _react2.default.createElement(\n          'a',\n          { className: 'mutedlink', href: url },\n          _react2.default.createElement('span', { className: 'glyphicon glyphicon-trash', title: remove_msg })\n        );\n        if (this.state.removal_count > 0) {\n          var fmts = _django2.default.ngettext(\"A user has flagged this comment as inappropriate.\", \"%s users have flagged this comment as inappropriate.\", this.state.removal_count);\n          var text = _django2.default.interpolate(fmts, [this.state.removal_count]);\n          moderate_html = _react2.default.createElement(\n            'span',\n            null,\n            moderate_html,\n            '\\xA0',\n            _react2.default.createElement(\n              'span',\n              { className: 'label label-warning', title: text },\n              this.state.removal_count\n            )\n          );\n        }\n      }\n\n      return _react2.default.createElement(\n        'p',\n        { className: 'pull-right' },\n        flagging_html,\n        ' ',\n        moderate_html\n      );\n    }\n  }, {\n    key: '_get_feedback_chunk',\n    value: function _get_feedback_chunk(dir) {\n      if (!this.props.settings.allow_feedback) return \"\";\n      var attr_list = dir + \"_users\"; // Produce (dis)like_users\n\n      var show_users_chunk = \"\";\n      if (this.props.settings.show_feedback) {\n\n        // Check whether the user is no longer liking/disliking the comment,\n        // and be sure the list list of users who liked/disliked the comment\n        // is up-to-date likewise.\n        var current_user_id = this.state.current_user.split(\":\")[0];\n        var user_ids = this.state[attr_list].map(function (item) {\n          return item.split(\":\")[0];\n        });\n        if (this.state[dir] && // If user expressed opinion, and\n        user_ids.indexOf(current_user_id) == -1) // user is not included.\n          {\n            // Append user to the list.\n            this.state[attr_list].push(this.state.current_user);\n          } else if (!this.state[dir] && // If user doesn't have an opinion\n        user_ids.indexOf(current_user_id) > -1) // user is included.\n          {\n            // Remove the user from the list.\n            var pos = user_ids.indexOf(current_user_id);\n            this.state[attr_list].splice(pos, 1);\n          }\n\n        if (this.state[attr_list].length) {\n          var users = this.state[attr_list].map(function (item) {\n            return item.split(\":\")[1];\n          });\n          users = users.join(\"<br/>\");\n          show_users_chunk = _react2.default.createElement(\n            'a',\n            { className: 'cfb-counter', 'data-toggle': 'tooltip', title: users },\n            _react2.default.createElement(\n              'span',\n              { className: 'small' },\n              this.state[attr_list].length\n            )\n          );\n        }\n      }\n\n      var css_class = this.state[dir] ? '' : 'mutedlink';\n      var icon = dir == 'like' ? 'thumbs-up' : 'thumbs-down';\n      var class_icon = \"small glyphicon glyphicon-\" + icon;\n      var click_hdl = dir == 'like' ? this.action_like : this.action_dislike;\n      var opinion = \"\",\n          link = \"#\";\n      if (dir == 'like') opinion = _django2.default.gettext('I like it');else opinion = _django2.default.gettext('I dislike it');\n\n      return _react2.default.createElement(\n        'span',\n        null,\n        show_users_chunk,\n        '  ',\n        _react2.default.createElement(\n          'a',\n          { href: '#', onClick: click_hdl,\n            className: css_class },\n          _react2.default.createElement('span', { className: class_icon, title: opinion })\n        )\n      );\n    }\n  }, {\n    key: 'render_feedback_btns',\n    value: function render_feedback_btns() {\n      if (this.props.settings.allow_feedback) {\n        var feedback_id = \"feedback-\" + this.props.data.id;\n        if (this.props.settings.show_feedback) this.destroyTooltips(feedback_id);\n        var like_feedback = this._get_feedback_chunk(\"like\");\n        var dislike_feedback = this._get_feedback_chunk(\"dislike\");\n        return _react2.default.createElement(\n          'span',\n          { id: feedback_id, className: 'small' },\n          like_feedback,\n          _react2.default.createElement(\n            'span',\n            { className: 'text-muted' },\n            ' | '\n          ),\n          dislike_feedback\n        );\n      } else return \"\";\n    }\n  }, {\n    key: 'handle_reply_click',\n    value: function handle_reply_click(event) {\n      event.preventDefault();\n      var component = this.state.reply_form.component;\n      var visible = !this.state.reply_form.show;\n      if (component == null) component = _react2.default.createElement(_commentform.CommentForm, { form: this.props.settings.form,\n        reply_to: this.props.data.id,\n        send_url: this.props.settings.send_url,\n        current_user: this.props.settings.current_user,\n        is_authenticated: this.props.settings.is_authenticated,\n        on_comment_created: this.props.on_comment_created });\n      this.setState({ reply_form: { component: component,\n          show: visible } });\n    }\n  }, {\n    key: '_get_reply_link_chunk',\n    value: function _get_reply_link_chunk() {\n      if (!this.props.data.allow_reply) return \"\";\n\n      var separator = \"\";\n      if (this.props.settings.allow_feedback) separator = _react2.default.createElement(\n        'span',\n        { className: 'text-muted' },\n        '\\u2022'\n      );\n      var url = this.props.settings.reply_url.replace('0', this.props.data.id);\n      var reply_label = _django2.default.gettext(\"Reply\");\n\n      return _react2.default.createElement(\n        'span',\n        null,\n        '\\xA0\\xA0',\n        separator,\n        '\\xA0\\xA0',\n        _react2.default.createElement(\n          'a',\n          { className: 'small mutedlink', href: url,\n            onClick: this.handle_reply_click },\n          reply_label\n        )\n      );\n    }\n  }, {\n    key: 'rawMarkup',\n    value: function rawMarkup() {\n      var md = new _remarkable2.default();\n      var rawMarkup = md.render(this.props.data.comment);\n      return { __html: rawMarkup };\n    }\n  }, {\n    key: 'render_comment_body',\n    value: function render_comment_body() {\n      if (this.props.data.is_removed) return _react2.default.createElement(\n        'p',\n        { className: 'text-muted' },\n        _react2.default.createElement(\n          'em',\n          null,\n          this.props.data.comment\n        )\n      );else return _react2.default.createElement('div', { className: 'content', dangerouslySetInnerHTML: this.rawMarkup() });\n    }\n  }, {\n    key: 'render_reply_form',\n    value: function render_reply_form() {\n      if (!this.state.reply_form.show) return \"\";\n      return _react2.default.createElement(\n        'div',\n        null,\n        this.state.reply_form.component\n      );\n    }\n  }, {\n    key: '_post_feedback',\n    value: function _post_feedback(flag) {\n      _jquery2.default.ajax({\n        method: 'POST',\n        url: this.props.settings.feedback_url,\n        data: { comment: this.props.data.id, flag: flag },\n        dataType: 'json',\n        cache: false,\n        statusCode: {\n          201: function () {\n            var state = {};\n            if (flag == 'like') this.setState({ like: true, dislike: false });else if (flag == 'dislike') this.setState({ dislike: true, like: false });\n          }.bind(this),\n          204: function () {\n            if (flag == 'like') this.setState({ like: false });else if (flag == 'dislike') this.setState({ dislike: false });\n          }.bind(this)\n        },\n        error: function (xhr, status, err) {\n          debugger;\n          if (xhr.status == 400 && xhr.responseJSON.non_field_errors.length) alert(xhr.responseJSON.non_field_errors[0]);else console.error(this.props.settings.feedback_url, status, err.toString());\n        }.bind(this)\n      });\n    }\n  }, {\n    key: 'action_like',\n    value: function action_like(event) {\n      event.preventDefault();\n      if (this.props.settings.is_authenticated) return this._post_feedback('like');else return window.location.href = this.props.settings.login_url + \"?next=\" + this.props.settings.like_url.replace('0', this.props.data.id);\n    }\n  }, {\n    key: 'action_dislike',\n    value: function action_dislike(event) {\n      event.preventDefault();\n      if (this.props.settings.is_authenticated) return this._post_feedback('dislike');else return window.location.href = this.props.settings.login_url + \"?next=\" + this.props.settings.dislike_url.replace('0', this.props.id);\n    }\n  }, {\n    key: 'is_hover',\n    value: function is_hover(elem) {\n      return elem.parentElement.querySelector(':hover') === elem;\n    }\n  }, {\n    key: 'destroyTooltips',\n    value: function destroyTooltips(feedback_id) {\n      // console.log(\"feedback_id = \"+feedback_id);\n      var elem = document.getElementById(feedback_id);\n      var is_hover = elem && this.is_hover(elem);\n      if (elem && !is_hover) {\n        (0, _jquery2.default)('#' + feedback_id + ' A[data-toggle=\"tooltip\"]').tooltip('destroy');\n      }\n    }\n  }, {\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var feedback_id = \"feedback-\" + this.props.data.id;\n      var options = { html: true, selector: '.cfb-counter' };\n      (0, _jquery2.default)('#' + feedback_id).tooltip(options);\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate() {\n      var feedback_id = \"feedback-\" + this.props.data.id;\n      var options = { html: true, selector: '.cfb-counter' };\n      (0, _jquery2.default)('#' + feedback_id).tooltip(options);\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      var feedback_id = \"feedback-\" + this.props.data.id;\n      var elem = document.getElementById(feedback_id);\n      var is_hover = elem && this.is_hover(elem);\n      if (elem && !is_hover) {\n        (0, _jquery2.default)('#' + feedback_id + ' A[data-toggle=\"tooltip\"]').tooltip('destroy');\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var user_name = this._get_username_chunk(); // Plain name or link.\n      var right_div = this._get_right_div_chunk(); // Flagging & moderation.\n      var comment_body = this.render_comment_body();\n      var feedback_btns = this.render_feedback_btns();\n      var reply_link = this._get_reply_link_chunk();\n      var comment_id = \"c\" + this.props.data.id;\n      var reply_form = this.render_reply_form();\n\n      var new_label = \"\";\n      if (this.props.newcids.indexOf(this.props.data.id) > -1) {\n        new_label = _react2.default.createElement(\n          'span',\n          null,\n          _react2.default.createElement(\n            'span',\n            { className: 'label label-success' },\n            'new'\n          ),\n          '\\xA0-\\xA0'\n        );\n      }\n\n      var children = \"\";\n      var settings = this.props.settings;\n      if (this.props.data.children != null) {\n        children = this.props.data.children.map(function (item) {\n          return _react2.default.createElement(Comment, { key: item.id,\n            data: item,\n            settings: settings,\n            newcids: this.props.newcids,\n            on_comment_created: this.props.on_comment_created });\n        }.bind(this));\n      }\n\n      return _react2.default.createElement(\n        'div',\n        { className: 'media', id: comment_id },\n        _react2.default.createElement(\n          'div',\n          { className: 'media-left' },\n          _react2.default.createElement('img', { src: this.props.data.user_avatar, height: '48', width: '48' })\n        ),\n        _react2.default.createElement(\n          'div',\n          { className: 'media-body' },\n          _react2.default.createElement(\n            'div',\n            { className: 'comment' },\n            _react2.default.createElement(\n              'h6',\n              { className: 'media-heading' },\n              new_label,\n              this.props.data.submit_date,\n              ' - ',\n              user_name,\n              '\\xA0\\xA0',\n              _react2.default.createElement(\n                'a',\n                { className: 'permalink', href: this.props.data.permalink },\n                '\\xB6'\n              ),\n              right_div\n            ),\n            _react2.default.createElement('a', { name: comment_id }),\n            comment_body,\n            feedback_btns,\n            reply_link,\n            reply_form\n          ),\n          children\n        )\n      );\n    }\n  }]);\n\n  return Comment;\n}(_react2.default.Component);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTAwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2RqYW5nb19jb21tZW50c194dGQvc3RhdGljL2RqYW5nb19jb21tZW50c194dGQvanMvc3JjL2NvbW1lbnQuanN4PzI2ODIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcbmltcG9ydCBkamFuZ28gZnJvbSAnZGphbmdvJztcblxuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBSZWFjdERPTSBmcm9tICdyZWFjdC1kb20nO1xuaW1wb3J0IFJlbWFya2FibGUgZnJvbSAncmVtYXJrYWJsZSc7XG5cbmltcG9ydCB7Q29tbWVudEZvcm19IGZyb20gJy4vY29tbWVudGZvcm0uanN4JztcblxuXG5leHBvcnQgY2xhc3MgQ29tbWVudCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBjdXJyZW50X3VzZXI6IHByb3BzLnNldHRpbmdzLmN1cnJlbnRfdXNlcixcbiAgICAgIHJlbW92YWw6IHByb3BzLmRhdGEuZmxhZ3MucmVtb3ZhbC5hY3RpdmUsXG4gICAgICByZW1vdmFsX2NvdW50OiBwcm9wcy5kYXRhLmZsYWdzLnJlbW92YWwuY291bnQsXG4gICAgICBsaWtlOiBwcm9wcy5kYXRhLmZsYWdzLmxpa2UuYWN0aXZlLFxuICAgICAgbGlrZV91c2VyczogcHJvcHMuZGF0YS5mbGFncy5saWtlLnVzZXJzIHx8IFtdLFxuICAgICAgZGlzbGlrZTogcHJvcHMuZGF0YS5mbGFncy5kaXNsaWtlLmFjdGl2ZSxcbiAgICAgIGRpc2xpa2VfdXNlcnM6IHByb3BzLmRhdGEuZmxhZ3MuZGlzbGlrZS51c2VycyB8fCBbXSxcbiAgICAgIHJlcGx5X2Zvcm06IHtcbiAgICAgICAgY29tcG9uZW50OiBudWxsLFxuICAgICAgICBzaG93OiBmYWxzZVxuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5hY3Rpb25fbGlrZSA9IHRoaXMuYWN0aW9uX2xpa2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLmFjdGlvbl9kaXNsaWtlID0gdGhpcy5hY3Rpb25fZGlzbGlrZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuaGFuZGxlX3JlcGx5X2NsaWNrID0gdGhpcy5oYW5kbGVfcmVwbHlfY2xpY2suYmluZCh0aGlzKTtcbiAgfVxuICBcbiAgX2dldF91c2VybmFtZV9jaHVuaygpIHtcbiAgICBsZXQgdXNlcm5hbWUgPSB0aGlzLnByb3BzLmRhdGEudXNlcl9uYW1lLCBtb2RlcmF0b3IgPSBcIlwiO1xuXG4gICAgaWYodGhpcy5wcm9wcy5kYXRhLnVzZXJfdXJsICYmICF0aGlzLnByb3BzLmRhdGEuaXNfcmVtb3ZlZClcbiAgICAgIHVzZXJuYW1lID0gPGEgaHJlZj17dGhpcy5wcm9wcy5kYXRhLnVzZXJfdXJsfT57dXNlcm5hbWV9PC9hPjtcblxuICAgIGlmKHRoaXMucHJvcHMuZGF0YS51c2VyX21vZGVyYXRvcikge1xuICAgICAgdmFyIGxhYmVsID0gZGphbmdvLmdldHRleHQoXCJtb2RlcmF0b3JcIik7XG4gICAgICBtb2RlcmF0b3IgPSAoPHNwYW4+XG4gICAgICAgICAgICAgICAgICAgJm5ic3A7PHNwYW4gY2xhc3NOYW1lPVwibGFiZWwgbGFiZWwtZGVmYXVsdFwiPntsYWJlbH08L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgPC9zcGFuPik7XG4gICAgfVxuICAgIHJldHVybiA8c3Bhbj57dXNlcm5hbWV9e21vZGVyYXRvcn08L3NwYW4+O1xuICB9XG5cbiAgX2dldF9yaWdodF9kaXZfY2h1bmsoKSB7XG4gICAgbGV0IGZsYWdnaW5nX2h0bWwgPSBcIlwiLCBtb2RlcmF0ZV9odG1sID0gXCJcIiwgdXJsID0gXCJcIjtcblxuICAgIGlmKHRoaXMucHJvcHMuZGF0YS5pc19yZW1vdmVkKVxuICAgICAgcmV0dXJuIFwiXCI7XG4gICAgXG4gICAgaWYgKHRoaXMucHJvcHMuc2V0dGluZ3MuYWxsb3dfZmxhZ2dpbmcpXG4gICAge1xuICAgICAgdmFyIGluYXBwcm9wcmlhdGVfbXNnID0gXCJcIjtcbiAgICAgIGlmKHRoaXMuc3RhdGUucmVtb3ZhbCkge1xuICAgICAgICBpbmFwcHJvcHJpYXRlX21zZyA9IGRqYW5nby5nZXR0ZXh0KFwiSSBmbGFnZ2VkIGl0IGFzIGluYXBwcm9wcmlhdGVcIik7XG4gICAgICAgIGZsYWdnaW5nX2h0bWwgPSAoXG4gICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1mbGFnIHRleHQtZGFuZ2VyXCJcbiAgICAgICAgICAgICAgICB0aXRsZT17aW5hcHByb3ByaWF0ZV9tc2d9PlxuICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLnNldHRpbmdzLmlzX2F1dGhlbnRpY2F0ZWQpIHtcbiAgICAgICAgICB1cmwgPSB0aGlzLnByb3BzLnNldHRpbmdzLmZsYWdfdXJsLnJlcGxhY2UoJzAnLCB0aGlzLnByb3BzLmRhdGEuaWQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHVybCA9ICh0aGlzLnByb3BzLnNldHRpbmdzLmxvZ2luX3VybCArIFwiP25leHQ9XCIgK1xuICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnNldHRpbmdzLmZsYWdfdXJsLnJlcGxhY2UoJzAnLCB0aGlzLnByb3BzLmRhdGEuaWQpKTtcbiAgICAgICAgfVxuICAgICAgICBpbmFwcHJvcHJpYXRlX21zZyA9IGRqYW5nby5nZXR0ZXh0KFwiZmxhZyBjb21tZW50IGFzIGluYXBwcm9wcmlhdGVcIik7XG4gICAgICAgIGZsYWdnaW5nX2h0bWwgPSAoXG4gICAgICAgICAgPGEgY2xhc3NOYW1lPVwibXV0ZWRsaW5rXCIgaHJlZj17dXJsfT5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImdseXBoaWNvbiBnbHlwaGljb24tZmxhZ1wiXG4gICAgICAgICAgICAgICAgICB0aXRsZT17aW5hcHByb3ByaWF0ZV9tc2d9Pjwvc3Bhbj5cbiAgICAgICAgICA8L2E+KTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgaWYodGhpcy5wcm9wcy5zZXR0aW5ncy5pc19hdXRoZW50aWNhdGVkICYmXG4gICAgICAgdGhpcy5wcm9wcy5zZXR0aW5ncy5jYW5fbW9kZXJhdGUpXG4gICAge1xuICAgICAgdmFyIHJlbW92ZV9tc2cgPSBkamFuZ28uZ2V0dGV4dChcInJlbW92ZSBjb21tZW50XCIpO1xuICAgICAgdXJsID0gdGhpcy5wcm9wcy5zZXR0aW5ncy5kZWxldGVfdXJsLnJlcGxhY2UoJzAnLCB0aGlzLnByb3BzLmRhdGEuaWQpO1xuICAgICAgbW9kZXJhdGVfaHRtbCA9IChcbiAgICAgICAgPGEgY2xhc3NOYW1lPVwibXV0ZWRsaW5rXCIgaHJlZj17dXJsfT5cbiAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJnbHlwaGljb24gZ2x5cGhpY29uLXRyYXNoXCIgdGl0bGU9e3JlbW92ZV9tc2d9PlxuICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgPC9hPik7XG4gICAgICBpZih0aGlzLnN0YXRlLnJlbW92YWxfY291bnQ+MCkge1xuICAgICAgICB2YXIgZm10cyA9IGRqYW5nby5uZ2V0dGV4dChcbiAgICAgICAgICBcIkEgdXNlciBoYXMgZmxhZ2dlZCB0aGlzIGNvbW1lbnQgYXMgaW5hcHByb3ByaWF0ZS5cIixcbiAgICAgICAgICBcIiVzIHVzZXJzIGhhdmUgZmxhZ2dlZCB0aGlzIGNvbW1lbnQgYXMgaW5hcHByb3ByaWF0ZS5cIixcbiAgICAgICAgICB0aGlzLnN0YXRlLnJlbW92YWxfY291bnQpO1xuICAgICAgICB2YXIgdGV4dCA9IGRqYW5nby5pbnRlcnBvbGF0ZShmbXRzLCBbdGhpcy5zdGF0ZS5yZW1vdmFsX2NvdW50XSk7XG4gICAgICAgIG1vZGVyYXRlX2h0bWwgPSAoXG4gICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICB7bW9kZXJhdGVfaHRtbH0mbmJzcDtcbiAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImxhYmVsIGxhYmVsLXdhcm5pbmdcIiB0aXRsZT17dGV4dH0+XG4gICAgICAgICAgICAgIHt0aGlzLnN0YXRlLnJlbW92YWxfY291bnR9PC9zcGFuPlxuICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIChcbiAgICAgIDxwIGNsYXNzTmFtZT1cInB1bGwtcmlnaHRcIj5cbiAgICAgICAge2ZsYWdnaW5nX2h0bWx9IHttb2RlcmF0ZV9odG1sfVxuICAgICAgPC9wPlxuICAgICk7XG4gIH1cblxuICBfZ2V0X2ZlZWRiYWNrX2NodW5rKGRpcikge1xuICAgIGlmKCF0aGlzLnByb3BzLnNldHRpbmdzLmFsbG93X2ZlZWRiYWNrKVxuICAgICAgcmV0dXJuIFwiXCI7XG4gICAgbGV0IGF0dHJfbGlzdCA9IGRpciArIFwiX3VzZXJzXCI7ICAvLyBQcm9kdWNlIChkaXMpbGlrZV91c2Vyc1xuXG4gICAgbGV0IHNob3dfdXNlcnNfY2h1bmsgPSBcIlwiO1xuICAgIGlmKHRoaXMucHJvcHMuc2V0dGluZ3Muc2hvd19mZWVkYmFjaykge1xuXG4gICAgICAvLyBDaGVjayB3aGV0aGVyIHRoZSB1c2VyIGlzIG5vIGxvbmdlciBsaWtpbmcvZGlzbGlraW5nIHRoZSBjb21tZW50LFxuICAgICAgLy8gYW5kIGJlIHN1cmUgdGhlIGxpc3QgbGlzdCBvZiB1c2VycyB3aG8gbGlrZWQvZGlzbGlrZWQgdGhlIGNvbW1lbnRcbiAgICAgIC8vIGlzIHVwLXRvLWRhdGUgbGlrZXdpc2UuXG4gICAgICBsZXQgY3VycmVudF91c2VyX2lkID0gdGhpcy5zdGF0ZS5jdXJyZW50X3VzZXIuc3BsaXQoXCI6XCIpWzBdO1xuICAgICAgbGV0IHVzZXJfaWRzID0gdGhpcy5zdGF0ZVthdHRyX2xpc3RdLm1hcChmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIHJldHVybiBpdGVtLnNwbGl0KFwiOlwiKVswXTtcbiAgICAgIH0pO1xuICAgICAgaWYodGhpcy5zdGF0ZVtkaXJdICYmICAgICAgIC8vIElmIHVzZXIgZXhwcmVzc2VkIG9waW5pb24sIGFuZFxuICAgICAgICAgKHVzZXJfaWRzLmluZGV4T2YoY3VycmVudF91c2VyX2lkKSA9PSAtMSkpIC8vIHVzZXIgaXMgbm90IGluY2x1ZGVkLlxuICAgICAgeyAvLyBBcHBlbmQgdXNlciB0byB0aGUgbGlzdC5cbiAgICAgICAgdGhpcy5zdGF0ZVthdHRyX2xpc3RdLnB1c2godGhpcy5zdGF0ZS5jdXJyZW50X3VzZXIpO1xuICAgICAgfSBlbHNlIGlmKCF0aGlzLnN0YXRlW2Rpcl0gJiYgLy8gSWYgdXNlciBkb2Vzbid0IGhhdmUgYW4gb3BpbmlvblxuICAgICAgICAgICAgICAgICh1c2VyX2lkcy5pbmRleE9mKGN1cnJlbnRfdXNlcl9pZCkgPiAtMSkpIC8vIHVzZXIgaXMgaW5jbHVkZWQuXG4gICAgICB7IC8vIFJlbW92ZSB0aGUgdXNlciBmcm9tIHRoZSBsaXN0LlxuICAgICAgICB2YXIgcG9zID0gdXNlcl9pZHMuaW5kZXhPZihjdXJyZW50X3VzZXJfaWQpO1xuICAgICAgICB0aGlzLnN0YXRlW2F0dHJfbGlzdF0uc3BsaWNlKHBvcywgMSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmKHRoaXMuc3RhdGVbYXR0cl9saXN0XS5sZW5ndGgpIHtcbiAgICAgICAgbGV0IHVzZXJzID0gdGhpcy5zdGF0ZVthdHRyX2xpc3RdLm1hcChmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgcmV0dXJuIGl0ZW0uc3BsaXQoXCI6XCIpWzFdO1xuICAgICAgICB9KTtcbiAgICAgICAgdXNlcnMgPSB1c2Vycy5qb2luKFwiPGJyLz5cIik7XG4gICAgICAgIHNob3dfdXNlcnNfY2h1bmsgPSAoXG4gICAgICAgICAgPGEgY2xhc3NOYW1lPVwiY2ZiLWNvdW50ZXJcIiBkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIiB0aXRsZT17dXNlcnN9PlxuICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwic21hbGxcIj5cbiAgICAgICAgICAgICAge3RoaXMuc3RhdGVbYXR0cl9saXN0XS5sZW5ndGh9XG4gICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgPC9hPlxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBjc3NfY2xhc3MgPSB0aGlzLnN0YXRlW2Rpcl0gPyAnJyA6ICdtdXRlZGxpbmsnO1xuICAgIHZhciBpY29uID0gZGlyID09ICdsaWtlJyA/ICd0aHVtYnMtdXAnIDogJ3RodW1icy1kb3duJztcbiAgICB2YXIgY2xhc3NfaWNvbiA9IFwic21hbGwgZ2x5cGhpY29uIGdseXBoaWNvbi1cIitpY29uO1xuICAgIHZhciBjbGlja19oZGwgPSBkaXIgPT0gJ2xpa2UnID8gdGhpcy5hY3Rpb25fbGlrZSA6IHRoaXMuYWN0aW9uX2Rpc2xpa2U7XG4gICAgdmFyIG9waW5pb249XCJcIiwgbGluaz1cIiNcIjtcbiAgICBpZiAoZGlyID09ICdsaWtlJylcbiAgICAgIG9waW5pb24gPSBkamFuZ28uZ2V0dGV4dCgnSSBsaWtlIGl0Jyk7XG4gICAgZWxzZSBvcGluaW9uID0gZGphbmdvLmdldHRleHQoJ0kgZGlzbGlrZSBpdCcpO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxzcGFuPlxuICAgICAgICB7c2hvd191c2Vyc19jaHVua30gIDxhIGhyZWY9XCIjXCIgb25DbGljaz17Y2xpY2tfaGRsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y3NzX2NsYXNzfT5cbiAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9e2NsYXNzX2ljb259IHRpdGxlPXtvcGluaW9ufT48L3NwYW4+XG4gICAgICAgIDwvYT5cbiAgICAgIDwvc3Bhbj5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyX2ZlZWRiYWNrX2J0bnMoKSB7XG4gICAgaWYodGhpcy5wcm9wcy5zZXR0aW5ncy5hbGxvd19mZWVkYmFjaylcbiAgICB7XG4gICAgICBsZXQgZmVlZGJhY2tfaWQgPSBcImZlZWRiYWNrLVwiK3RoaXMucHJvcHMuZGF0YS5pZDtcbiAgICAgIGlmKHRoaXMucHJvcHMuc2V0dGluZ3Muc2hvd19mZWVkYmFjaylcbiAgICAgICAgdGhpcy5kZXN0cm95VG9vbHRpcHMoZmVlZGJhY2tfaWQpO1xuICAgICAgbGV0IGxpa2VfZmVlZGJhY2sgPSB0aGlzLl9nZXRfZmVlZGJhY2tfY2h1bmsoXCJsaWtlXCIpO1xuICAgICAgbGV0IGRpc2xpa2VfZmVlZGJhY2sgPSB0aGlzLl9nZXRfZmVlZGJhY2tfY2h1bmsoXCJkaXNsaWtlXCIpO1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgPHNwYW4gaWQ9e2ZlZWRiYWNrX2lkfSBjbGFzc05hbWU9XCJzbWFsbFwiPlxuICAgICAgICAgIHtsaWtlX2ZlZWRiYWNrfVxuICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInRleHQtbXV0ZWRcIj4gfCA8L3NwYW4+XG4gICAgICAgICAge2Rpc2xpa2VfZmVlZGJhY2t9XG4gICAgICAgIDwvc3Bhbj5cbiAgICAgICk7XG4gICAgfSBlbHNlXG4gICAgICByZXR1cm4gXCJcIjtcbiAgfVxuICBcbiAgaGFuZGxlX3JlcGx5X2NsaWNrKGV2ZW50KSB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB2YXIgY29tcG9uZW50ID0gdGhpcy5zdGF0ZS5yZXBseV9mb3JtLmNvbXBvbmVudDtcbiAgICB2YXIgdmlzaWJsZSA9ICF0aGlzLnN0YXRlLnJlcGx5X2Zvcm0uc2hvdztcbiAgICBpZihjb21wb25lbnQ9PW51bGwpIFxuICAgICAgY29tcG9uZW50ID0gKFxuICAgICAgICA8Q29tbWVudEZvcm0gZm9ybT17dGhpcy5wcm9wcy5zZXR0aW5ncy5mb3JtfVxuICAgICAgICAgICAgICAgICAgICAgcmVwbHlfdG89e3RoaXMucHJvcHMuZGF0YS5pZH1cbiAgICAgICAgICAgICAgICAgICAgIHNlbmRfdXJsPXt0aGlzLnByb3BzLnNldHRpbmdzLnNlbmRfdXJsfVxuICAgICAgICAgICAgICAgICAgICAgY3VycmVudF91c2VyPXt0aGlzLnByb3BzLnNldHRpbmdzLmN1cnJlbnRfdXNlcn1cbiAgICAgICAgICAgICAgICAgICAgIGlzX2F1dGhlbnRpY2F0ZWQ9e3RoaXMucHJvcHMuc2V0dGluZ3MuaXNfYXV0aGVudGljYXRlZH1cbiAgICAgICAgICAgICAgICAgICAgIG9uX2NvbW1lbnRfY3JlYXRlZD17dGhpcy5wcm9wcy5vbl9jb21tZW50X2NyZWF0ZWR9IC8+XG4gICAgICApO1xuICAgIHRoaXMuc2V0U3RhdGUoe3JlcGx5X2Zvcm06IHtjb21wb25lbnQ6IGNvbXBvbmVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzogdmlzaWJsZX19KTtcbiAgfVxuXG4gIF9nZXRfcmVwbHlfbGlua19jaHVuaygpIHtcbiAgICBpZighdGhpcy5wcm9wcy5kYXRhLmFsbG93X3JlcGx5KVxuICAgICAgcmV0dXJuIFwiXCI7XG4gICAgXG4gICAgbGV0IHNlcGFyYXRvciA9IFwiXCI7XG4gICAgaWYodGhpcy5wcm9wcy5zZXR0aW5ncy5hbGxvd19mZWVkYmFjaylcbiAgICAgIHNlcGFyYXRvciA9IDxzcGFuIGNsYXNzTmFtZT1cInRleHQtbXV0ZWRcIj4mYnVsbDs8L3NwYW4+O1xuICAgIGxldCB1cmwgPSB0aGlzLnByb3BzLnNldHRpbmdzLnJlcGx5X3VybC5yZXBsYWNlKCcwJywgdGhpcy5wcm9wcy5kYXRhLmlkKTtcbiAgICBsZXQgcmVwbHlfbGFiZWwgPSBkamFuZ28uZ2V0dGV4dChcIlJlcGx5XCIpO1xuICAgIFxuICAgIHJldHVybiAoXG4gICAgICA8c3Bhbj4mbmJzcDsmbmJzcDt7c2VwYXJhdG9yfSZuYnNwOyZuYnNwO1xuICAgICAgICA8YSBjbGFzc05hbWU9XCJzbWFsbCBtdXRlZGxpbmtcIiBocmVmPXt1cmx9XG4gICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuaGFuZGxlX3JlcGx5X2NsaWNrfT57cmVwbHlfbGFiZWx9PC9hPlxuICAgICAgPC9zcGFuPlxuICAgICk7XG4gIH1cblxuICByYXdNYXJrdXAoKSB7XG4gICAgdmFyIG1kID0gbmV3IFJlbWFya2FibGUoKTtcbiAgICBjb25zdCByYXdNYXJrdXAgPSBtZC5yZW5kZXIodGhpcy5wcm9wcy5kYXRhLmNvbW1lbnQpO1xuICAgIHJldHVybiB7IF9faHRtbDogcmF3TWFya3VwIH07XG4gIH1cbiAgXG4gIHJlbmRlcl9jb21tZW50X2JvZHkoKSB7ICBcbiAgICBpZih0aGlzLnByb3BzLmRhdGEuaXNfcmVtb3ZlZClcbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtbXV0ZWRcIj48ZW0+e3RoaXMucHJvcHMuZGF0YS5jb21tZW50fTwvZW0+PC9wPlxuICAgICAgKTtcbiAgICBlbHNlXG4gICAgICByZXR1cm4gKFxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRlbnRcIiBkYW5nZXJvdXNseVNldElubmVySFRNTD17dGhpcy5yYXdNYXJrdXAoKX0vPlxuICAgICAgKTtcbiAgfVxuXG4gIHJlbmRlcl9yZXBseV9mb3JtKCkge1xuICAgIGlmKCF0aGlzLnN0YXRlLnJlcGx5X2Zvcm0uc2hvdylcbiAgICAgIHJldHVybiBcIlwiO1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2Pnt0aGlzLnN0YXRlLnJlcGx5X2Zvcm0uY29tcG9uZW50fTwvZGl2PlxuICAgICk7XG4gIH1cbiAgXG4gIF9wb3N0X2ZlZWRiYWNrKGZsYWcpIHtcbiAgICAkLmFqYXgoe1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICB1cmw6IHRoaXMucHJvcHMuc2V0dGluZ3MuZmVlZGJhY2tfdXJsLFxuICAgICAgZGF0YToge2NvbW1lbnQ6IHRoaXMucHJvcHMuZGF0YS5pZCwgZmxhZzogZmxhZ30sXG4gICAgICBkYXRhVHlwZTogJ2pzb24nLFxuICAgICAgY2FjaGU6IGZhbHNlLFxuICAgICAgc3RhdHVzQ29kZToge1xuICAgICAgICAyMDE6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGxldCBzdGF0ZSA9IHt9O1xuICAgICAgICAgIGlmKGZsYWc9PSdsaWtlJylcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2xpa2U6IHRydWUsIGRpc2xpa2U6IGZhbHNlfSk7XG4gICAgICAgICAgZWxzZSBpZihmbGFnPT0nZGlzbGlrZScpXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtkaXNsaWtlOiB0cnVlLCBsaWtlOiBmYWxzZX0pO1xuICAgICAgICB9LmJpbmQodGhpcyksXG4gICAgICAgIDIwNDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYoZmxhZz09J2xpa2UnKVxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7bGlrZTogZmFsc2V9KTtcbiAgICAgICAgICBlbHNlIGlmKGZsYWc9PSdkaXNsaWtlJylcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2Rpc2xpa2U6IGZhbHNlfSk7XG4gICAgICAgIH0uYmluZCh0aGlzKVxuICAgICAgfSxcbiAgICAgIGVycm9yOiBmdW5jdGlvbih4aHIsIHN0YXR1cywgZXJyKSB7XG4gICAgICAgIGRlYnVnZ2VyO1xuICAgICAgICBpZih4aHIuc3RhdHVzPT00MDAgJiYgeGhyLnJlc3BvbnNlSlNPTi5ub25fZmllbGRfZXJyb3JzLmxlbmd0aClcbiAgICAgICAgICBhbGVydCh4aHIucmVzcG9uc2VKU09OLm5vbl9maWVsZF9lcnJvcnNbMF0pO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgY29uc29sZS5lcnJvcih0aGlzLnByb3BzLnNldHRpbmdzLmZlZWRiYWNrX3VybCwgc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyLnRvU3RyaW5nKCkpO1xuICAgICAgfS5iaW5kKHRoaXMpXG4gICAgfSk7XG4gIH1cblxuICBhY3Rpb25fbGlrZShldmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgaWYodGhpcy5wcm9wcy5zZXR0aW5ncy5pc19hdXRoZW50aWNhdGVkKVxuICAgICAgcmV0dXJuIHRoaXMuX3Bvc3RfZmVlZGJhY2soJ2xpa2UnKTtcbiAgICBlbHNlXG4gICAgICByZXR1cm4gd2luZG93LmxvY2F0aW9uLmhyZWYgPSAoXG4gICAgICAgIHRoaXMucHJvcHMuc2V0dGluZ3MubG9naW5fdXJsICsgXCI/bmV4dD1cIiArXG4gICAgICAgIHRoaXMucHJvcHMuc2V0dGluZ3MubGlrZV91cmwucmVwbGFjZSgnMCcsIHRoaXMucHJvcHMuZGF0YS5pZClcbiAgICAgICk7XG4gIH1cblxuICBhY3Rpb25fZGlzbGlrZShldmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgaWYodGhpcy5wcm9wcy5zZXR0aW5ncy5pc19hdXRoZW50aWNhdGVkKVxuICAgICAgcmV0dXJuIHRoaXMuX3Bvc3RfZmVlZGJhY2soJ2Rpc2xpa2UnKTtcbiAgICBlbHNlXG4gICAgICByZXR1cm4gd2luZG93LmxvY2F0aW9uLmhyZWYgPSAoXG4gICAgICAgIHRoaXMucHJvcHMuc2V0dGluZ3MubG9naW5fdXJsICsgXCI/bmV4dD1cIiArXG4gICAgICAgIHRoaXMucHJvcHMuc2V0dGluZ3MuZGlzbGlrZV91cmwucmVwbGFjZSgnMCcsIHRoaXMucHJvcHMuaWQpXG4gICAgICApO1xuICB9XG5cbiAgaXNfaG92ZXIoZWxlbSkge1xuICAgIHJldHVybiAoZWxlbS5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJzpob3ZlcicpID09PSBlbGVtKTtcbiAgfVxuXG4gIGRlc3Ryb3lUb29sdGlwcyhmZWVkYmFja19pZCkge1xuICAgIC8vIGNvbnNvbGUubG9nKFwiZmVlZGJhY2tfaWQgPSBcIitmZWVkYmFja19pZCk7XG4gICAgdmFyIGVsZW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmZWVkYmFja19pZCk7XG4gICAgdmFyIGlzX2hvdmVyID0gZWxlbSAmJiB0aGlzLmlzX2hvdmVyKGVsZW0pO1xuICAgIGlmKGVsZW0gJiYgIWlzX2hvdmVyKSB7XG4gICAgICAkKCcjJytmZWVkYmFja19pZCsnIEFbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykudG9vbHRpcCgnZGVzdHJveScpO1xuICAgIH1cbiAgfVxuICBcbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdmFyIGZlZWRiYWNrX2lkID0gXCJmZWVkYmFjay1cIiArIHRoaXMucHJvcHMuZGF0YS5pZDtcbiAgICB2YXIgb3B0aW9ucyA9IHtodG1sOiB0cnVlLCBzZWxlY3RvcjogJy5jZmItY291bnRlcid9O1xuICAgICQoJyMnK2ZlZWRiYWNrX2lkKS50b29sdGlwKG9wdGlvbnMpO1xuICB9XG5cbiAgY29tcG9uZW50RGlkVXBkYXRlKCkge1xuICAgIHZhciBmZWVkYmFja19pZCA9IFwiZmVlZGJhY2stXCIgKyB0aGlzLnByb3BzLmRhdGEuaWQ7XG4gICAgdmFyIG9wdGlvbnMgPSB7aHRtbDogdHJ1ZSwgc2VsZWN0b3I6ICcuY2ZiLWNvdW50ZXInfTtcbiAgICAkKCcjJytmZWVkYmFja19pZCkudG9vbHRpcChvcHRpb25zKTtcbiAgfVxuICBcbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgdmFyIGZlZWRiYWNrX2lkID0gXCJmZWVkYmFjay1cIiArIHRoaXMucHJvcHMuZGF0YS5pZDtcbiAgICB2YXIgZWxlbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZlZWRiYWNrX2lkKTtcbiAgICB2YXIgaXNfaG92ZXIgPSBlbGVtICYmIHRoaXMuaXNfaG92ZXIoZWxlbSk7XG4gICAgaWYoZWxlbSAmJiAhaXNfaG92ZXIpIHtcbiAgICAgICQoJyMnK2ZlZWRiYWNrX2lkKycgQVtkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIl0nKS50b29sdGlwKCdkZXN0cm95Jyk7XG4gICAgfVxuICB9XG4gIFxuICByZW5kZXIoKSB7XG4gICAgdmFyIHVzZXJfbmFtZSA9IHRoaXMuX2dldF91c2VybmFtZV9jaHVuaygpOyAgLy8gUGxhaW4gbmFtZSBvciBsaW5rLlxuICAgIHZhciByaWdodF9kaXYgPSB0aGlzLl9nZXRfcmlnaHRfZGl2X2NodW5rKCk7ICAvLyBGbGFnZ2luZyAmIG1vZGVyYXRpb24uXG4gICAgdmFyIGNvbW1lbnRfYm9keSA9IHRoaXMucmVuZGVyX2NvbW1lbnRfYm9keSgpO1xuICAgIHZhciBmZWVkYmFja19idG5zID0gdGhpcy5yZW5kZXJfZmVlZGJhY2tfYnRucygpO1xuICAgIHZhciByZXBseV9saW5rID0gdGhpcy5fZ2V0X3JlcGx5X2xpbmtfY2h1bmsoKTtcbiAgICB2YXIgY29tbWVudF9pZCA9IFwiY1wiICsgdGhpcy5wcm9wcy5kYXRhLmlkO1xuICAgIHZhciByZXBseV9mb3JtID0gdGhpcy5yZW5kZXJfcmVwbHlfZm9ybSgpO1xuXG4gICAgdmFyIG5ld19sYWJlbCA9IFwiXCI7XG4gICAgaWYgKHRoaXMucHJvcHMubmV3Y2lkcy5pbmRleE9mKHRoaXMucHJvcHMuZGF0YS5pZCkgPiAtMSkge1xuICAgICAgbmV3X2xhYmVsID0gKFxuICAgICAgICA8c3Bhbj5cbiAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJsYWJlbCBsYWJlbC1zdWNjZXNzXCI+bmV3PC9zcGFuPiZuYnNwOy0mbmJzcDtcbiAgICAgICAgPC9zcGFuPlxuICAgICAgKTtcbiAgICB9XG4gICAgXG4gICAgdmFyIGNoaWxkcmVuID0gXCJcIjtcbiAgICB2YXIgc2V0dGluZ3MgPSB0aGlzLnByb3BzLnNldHRpbmdzO1xuICAgIGlmICh0aGlzLnByb3BzLmRhdGEuY2hpbGRyZW4gIT0gbnVsbCkge1xuICAgICAgY2hpbGRyZW4gPSB0aGlzLnByb3BzLmRhdGEuY2hpbGRyZW4ubWFwKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICA8Q29tbWVudCBrZXk9e2l0ZW0uaWR9XG4gICAgICAgICAgICAgICAgICAgZGF0YT17aXRlbX1cbiAgICAgICAgICAgICAgICAgICBzZXR0aW5ncz17c2V0dGluZ3N9XG4gICAgICAgICAgICAgICAgICAgbmV3Y2lkcz17dGhpcy5wcm9wcy5uZXdjaWRzfVxuICAgICAgICAgICAgICAgICAgIG9uX2NvbW1lbnRfY3JlYXRlZD17dGhpcy5wcm9wcy5vbl9jb21tZW50X2NyZWF0ZWR9IC8+XG4gICAgICAgICk7XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJtZWRpYVwiIGlkPXtjb21tZW50X2lkfT5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtZWRpYS1sZWZ0XCI+XG4gICAgICAgICAgPGltZyBzcmM9e3RoaXMucHJvcHMuZGF0YS51c2VyX2F2YXRhcn0gaGVpZ2h0PVwiNDhcIiB3aWR0aD1cIjQ4XCIgLz5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWVkaWEtYm9keVwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29tbWVudFwiPlxuICAgICAgICAgICAgPGg2IGNsYXNzTmFtZT1cIm1lZGlhLWhlYWRpbmdcIj5cbiAgICAgICAgICAgICAge25ld19sYWJlbH17dGhpcy5wcm9wcy5kYXRhLnN1Ym1pdF9kYXRlfSAtIHt1c2VyX25hbWV9XG4gICAgICAgICAgICAgICZuYnNwOyZuYnNwO1xuICAgICAgICAgICAgICA8YSBjbGFzc05hbWU9XCJwZXJtYWxpbmtcIiBocmVmPXt0aGlzLnByb3BzLmRhdGEucGVybWFsaW5rfT7CtjwvYT5cbiAgICAgICAgICAgICAge3JpZ2h0X2Rpdn1cbiAgICAgICAgICAgIDwvaDY+XG4gICAgICAgICAgICA8YSBuYW1lPXtjb21tZW50X2lkfT48L2E+XG4gICAgICAgICAgICB7Y29tbWVudF9ib2R5fXtmZWVkYmFja19idG5zfXtyZXBseV9saW5rfVxuICAgICAgICAgICAge3JlcGx5X2Zvcm19XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAge2NoaWxkcmVufVxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBkamFuZ29fY29tbWVudHNfeHRkL3N0YXRpYy9kamFuZ29fY29tbWVudHNfeHRkL2pzL3NyYy9jb21tZW50LmpzeCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7Ozs7Ozs7O0FBRUE7OztBQUNBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFSQTtBQWFBO0FBQ0E7QUFDQTtBQWpCQTtBQWtCQTtBQUNBOzs7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFEQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7OztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQURBO0FBSUE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFGQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBSUE7OztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBREE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFGQTtBQURBO0FBT0E7OztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBSEE7QUFNQTtBQUVBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQURBO0FBREE7QUFLQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFNQTs7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUlBO0FBYkE7QUFlQTtBQUNBO0FBQ0E7QUFLQTtBQTVCQTtBQThCQTs7O0FBRUE7QUFDQTtBQUNBO0FBT0E7OztBQUVBO0FBQ0E7QUFDQTtBQU9BOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBREE7QUFBQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBR0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQURBO0FBQ0E7QUFEQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQVRBO0FBV0E7QUFaQTtBQUpBO0FBb0JBOzs7O0FBOVhBIiwic291cmNlUm9vdCI6IiJ9");

/***/ }),

/***/ 101:
/* unknown exports provided */
/* all exports used */
/*!************************************************************************!*\
  !*** ./django_comments_xtd/static/django_comments_xtd/js/src/index.js ***!
  \************************************************************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _react = __webpack_require__(/*! react */ 19);\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = __webpack_require__(/*! react-dom */ 18);\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _commentbox = __webpack_require__(/*! ./commentbox.jsx */ 98);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n_reactDom2.default.render(_react2.default.createElement(_commentbox.CommentBox, Object.assign(window.comments_props, window.comments_props_override)), document.getElementById('comments'));//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTAxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2RqYW5nb19jb21tZW50c194dGQvc3RhdGljL2RqYW5nb19jb21tZW50c194dGQvanMvc3JjL2luZGV4LmpzPzg3ZjciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBSZWFjdERPTSBmcm9tICdyZWFjdC1kb20nO1xuXG5pbXBvcnQge0NvbW1lbnRCb3h9IGZyb20gJy4vY29tbWVudGJveC5qc3gnO1xuXG5cblJlYWN0RE9NLnJlbmRlcihcbiAgUmVhY3QuY3JlYXRlRWxlbWVudChDb21tZW50Qm94LFxuICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24od2luZG93LmNvbW1lbnRzX3Byb3BzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmNvbW1lbnRzX3Byb3BzX292ZXJyaWRlKSksXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb21tZW50cycpXG4pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGRqYW5nb19jb21tZW50c194dGQvc3RhdGljL2RqYW5nb19jb21tZW50c194dGQvanMvc3JjL2luZGV4LmpzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7OztBQUVBIiwic291cmNlUm9vdCI6IiJ9");

/***/ }),

/***/ 37:
/* unknown exports provided */
/* all exports used */
/*!*************************!*\
  !*** external "jQuery" ***!
  \*************************/
/***/ (function(module, exports) {

eval("module.exports = jQuery;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJqUXVlcnlcIj8wY2I4Il0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0galF1ZXJ5O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwialF1ZXJ5XCJcbi8vIG1vZHVsZSBpZCA9IDM3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJtYXBwaW5ncyI6IkFBQUEiLCJzb3VyY2VSb290IjoiIn0=");

/***/ }),

/***/ 58:
/* unknown exports provided */
/* all exports used */
/*!*************************!*\
  !*** external "django" ***!
  \*************************/
/***/ (function(module, exports) {

eval("module.exports = django;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJkamFuZ29cIj9jOGVhIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gZGphbmdvO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiZGphbmdvXCJcbi8vIG1vZHVsZSBpZCA9IDU4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJtYXBwaW5ncyI6IkFBQUEiLCJzb3VyY2VSb290IjoiIn0=");

/***/ }),

/***/ 60:
/* unknown exports provided */
/* all exports used */
/*!*******************************************************************************!*\
  !*** ./django_comments_xtd/static/django_comments_xtd/js/src/commentform.jsx ***!
  \*******************************************************************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CommentForm = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _jquery = __webpack_require__(/*! jquery */ 37);\n\nvar _jquery2 = _interopRequireDefault(_jquery);\n\nvar _django = __webpack_require__(/*! django */ 58);\n\nvar _django2 = _interopRequireDefault(_django);\n\nvar _md = __webpack_require__(/*! md5 */ 59);\n\nvar _md2 = _interopRequireDefault(_md);\n\nvar _react = __webpack_require__(/*! react */ 19);\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = __webpack_require__(/*! react-dom */ 18);\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _remarkable = __webpack_require__(/*! remarkable */ 38);\n\nvar _remarkable2 = _interopRequireDefault(_remarkable);\n\nvar _lib = __webpack_require__(/*! ./lib.js */ 61);\n\nvar lib = _interopRequireWildcard(_lib);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar CommentForm = exports.CommentForm = function (_React$Component) {\n  _inherits(CommentForm, _React$Component);\n\n  function CommentForm(props) {\n    _classCallCheck(this, CommentForm);\n\n    var _this = _possibleConstructorReturn(this, (CommentForm.__proto__ || Object.getPrototypeOf(CommentForm)).call(this, props));\n\n    _this.state = {\n      name: '', email: '', url: '', followup: false, comment: '',\n      reply_to: _this.props.reply_to || 0,\n      visited: { name: false, email: false, comment: false },\n      errors: { name: false, email: false, comment: false },\n      previewing: false,\n      alert: { message: '', cssc: '' }\n    };\n    _this.handle_input_change = _this.handle_input_change.bind(_this);\n    _this.handle_blur = _this.handle_blur.bind(_this);\n    _this.handle_submit = _this.handle_submit.bind(_this);\n    _this.handle_preview = _this.handle_preview.bind(_this);\n    _this.reset_form = _this.reset_form.bind(_this);\n    _this.fhelp = _react2.default.createElement(\n      'span',\n      { className: 'help-block' },\n      'This field is required.'\n    );\n    return _this;\n  }\n\n  _createClass(CommentForm, [{\n    key: 'handle_input_change',\n    value: function handle_input_change(event) {\n      var target = event.target;\n      var value = target.type === 'checkbox' ? target.checked : target.value;\n      var iname = target.name;\n\n      this.setState(_defineProperty({}, iname, value));\n    }\n  }, {\n    key: 'handle_blur',\n    value: function handle_blur(field) {\n      function handler(event) {\n        var visited = this.state.visited;\n        visited[field] = true;\n        this.setState({ visited: visited });\n      };\n      return handler.bind(this);\n    }\n  }, {\n    key: 'validate',\n    value: function validate() {\n      var errors = this.state.errors;\n\n      if (!this.state.comment.length) errors.comment = true;else errors.comment = false;\n      if (!this.props.is_authenticated) {\n        if (!this.state.name.length) errors.name = true;else errors.name = false;\n        if (/\\S+@\\S+\\.\\S+/.test(this.state.email)) errors.email = false;else errors.email = true;\n      } else {\n        errors.name = false;\n        errors.email = false;\n      }\n      this.setState({ errors: errors });\n\n      if (this.state.errors.comment || this.state.errors.name || this.state.errors.email) return false;else return true;\n    }\n  }, {\n    key: 'render_field_comment',\n    value: function render_field_comment() {\n      var cssc = \"form-group \",\n          help = \"\";\n      if (this.state.errors.comment) {\n        cssc += this.state.errors.comment ? \"has-error\" : \"\";\n        help = this.fhelp;\n      }\n      var placeholder = _django2.default.gettext(\"Your comment\");\n      return _react2.default.createElement(\n        'div',\n        { className: cssc },\n        _react2.default.createElement(\n          'div',\n          { className: 'col-lg-offset-1 col-md-offset-1 col-lg-10 col-md-10' },\n          _react2.default.createElement('textarea', { required: true, name: 'comment', id: 'id_comment',\n            placeholder: placeholder, maxLength: '3000',\n            className: 'form-control', value: this.state.comment,\n            onChange: this.handle_input_change,\n            onBlur: this.handle_blur('comment') }),\n          help\n        )\n      );\n    }\n  }, {\n    key: 'render_field_name',\n    value: function render_field_name() {\n      if (this.props.is_authenticated) return \"\";\n      var div_cssc = \"form-group\",\n          input_cssc = \"form-control\",\n          help = \"\";\n      if (this.state.reply_to > 0) {\n        div_cssc += \" form-group-sm\";\n        input_cssc += \" input-sm\";\n      }\n      if (this.state.errors.name) {\n        div_cssc += \" has-error\";\n        help = this.fhelp;\n      }\n      var placeholder = _django2.default.gettext('name');\n      return _react2.default.createElement(\n        'div',\n        { className: div_cssc },\n        _react2.default.createElement(\n          'label',\n          { htmlFor: 'id_name', className: 'control-label col-lg-3 col-md-3' },\n          _django2.default.gettext(\"Name\")\n        ),\n        _react2.default.createElement(\n          'div',\n          { className: 'col-lg-7 col-md-7' },\n          _react2.default.createElement('input', { type: 'text', name: 'name', required: true, id: 'id_name',\n            value: this.state.name, placeholder: placeholder,\n            onChange: this.handle_input_change,\n            onBlur: this.handle_blur('name'),\n            className: input_cssc }),\n          help\n        )\n      );\n    }\n  }, {\n    key: 'render_field_email',\n    value: function render_field_email() {\n      if (this.props.is_authenticated) return \"\";\n      var div_cssc = \"form-group\",\n          input_cssc = \"form-control\";\n      if (this.state.reply_to > 0) {\n        div_cssc += \" form-group-sm\";\n        input_cssc += \" input-sm\";\n      }\n      if (this.state.errors.email) div_cssc += \" has-error\";\n      var placeholder = _django2.default.gettext('mail address');\n      var helptext = _django2.default.gettext('Required for comment verification.');\n      return _react2.default.createElement(\n        'div',\n        { className: div_cssc },\n        _react2.default.createElement(\n          'label',\n          { htmlFor: 'id_email', className: 'control-label col-lg-3 col-md-3' },\n          _django2.default.gettext(\"Mail\")\n        ),\n        _react2.default.createElement(\n          'div',\n          { className: 'col-lg-7 col-md-7' },\n          _react2.default.createElement('input', { type: 'text', name: 'email', required: true, id: 'id_email',\n            value: this.state.email, placeholder: placeholder,\n            onChange: this.handle_input_change,\n            onBlur: this.handle_blur('email'),\n            className: input_cssc }),\n          _react2.default.createElement(\n            'span',\n            { className: 'help-block' },\n            helptext\n          )\n        )\n      );\n    }\n  }, {\n    key: 'render_field_url',\n    value: function render_field_url() {\n      if (this.props.is_authenticated) return \"\";\n      var div_cssc = \"form-group\",\n          input_cssc = \"form-control\";\n      if (this.state.reply_to > 0) {\n        div_cssc += \" form-group-sm\";\n        input_cssc += \" input-sm\";\n      }\n      if (this.state.errors.url) div_cssc += \" form-group\";\n      var placeholder = _django2.default.gettext(\"url your name links to (optional)\");\n      return _react2.default.createElement(\n        'div',\n        { className: div_cssc },\n        _react2.default.createElement(\n          'label',\n          { htmlFor: 'id_url', className: 'control-label col-lg-3 col-md-3' },\n          _django2.default.gettext(\"Link\")\n        ),\n        _react2.default.createElement(\n          'div',\n          { className: 'col-lg-7 col-md-7' },\n          _react2.default.createElement('input', { type: 'text', name: 'url', id: 'id_url', value: this.state.url,\n            placeholder: placeholder,\n            onChange: this.handle_input_change,\n            className: input_cssc })\n        )\n      );\n    }\n  }, {\n    key: 'render_field_followup',\n    value: function render_field_followup() {\n      var div_cssc = \"checkbox\";\n      if (this.state.reply_to > 0) div_cssc += \" small\";\n      var label = _django2.default.gettext(\"Notify me about follow-up comments\");\n      return _react2.default.createElement(\n        'div',\n        { className: 'form-group' },\n        _react2.default.createElement(\n          'div',\n          { className: 'col-lg-offset-3 col-md-offset-3 col-lg-7 col-md-7' },\n          _react2.default.createElement(\n            'div',\n            { className: div_cssc },\n            _react2.default.createElement(\n              'label',\n              { htmlFor: 'id_followup' },\n              _react2.default.createElement('input', { type: 'checkbox', checked: this.state.followup,\n                onChange: this.handle_input_change,\n                name: 'followup', id: 'id_followup' }),\n              '\\xA0',\n              label\n            )\n          )\n        )\n      );\n    }\n  }, {\n    key: 'reset_form',\n    value: function reset_form() {\n      this.setState({\n        name: '', email: '', url: '', followup: false, comment: '',\n        visited: { name: false, email: false, comment: false },\n        errors: { name: false, email: false, comment: false }\n      });\n    }\n  }, {\n    key: 'handle_submit',\n    value: function handle_submit(event) {\n      event.preventDefault();\n      if (!this.validate()) return;\n\n      var data = {\n        content_type: this.props.form.content_type,\n        object_pk: this.props.form.object_pk,\n        timestamp: this.props.form.timestamp,\n        security_hash: this.props.form.security_hash,\n        honeypot: '',\n        comment: this.state.comment,\n        name: this.state.name,\n        email: this.state.email,\n        url: this.state.url,\n        followup: this.state.followup,\n        reply_to: this.state.reply_to\n      };\n      var cssc = \"alert alert-\";\n      var msg_202 = _django2.default.gettext(\"Your comment will be reviewed. Thank your for your patience.\");\n      var msg_204 = _django2.default.gettext(\"Thank you, a comment confirmation request has been sent by mail.\");\n      var msg_403 = _django2.default.gettext(\"Sorry, your comment has been rejected.\");\n      var message = {\n        202: msg_202,\n        204: msg_204,\n        403: msg_403\n      };\n\n      _jquery2.default.ajax({\n        method: 'POST',\n        url: this.props.send_url,\n        data: data,\n        dataType: 'json',\n        cache: false,\n        success: function (data, textStatus, xhr) {\n          if ([201, 202, 204, 403].indexOf(xhr.status) > -1) {\n            var css_class = \"\";\n            if (xhr.status == 403) css_class = cssc + \"danger\";else css_class = cssc + \"info\";\n            this.setState({ alert: { message: message[xhr.status],\n                cssc: css_class },\n              previewing: false });\n            this.reset_form();\n            this.props.on_comment_created();\n          }\n        }.bind(this),\n        error: function (xhr, status, err) {\n          console.error(this.props.send_url, status, err.toString());\n        }.bind(this)\n      });\n    }\n  }, {\n    key: 'handle_preview',\n    value: function handle_preview(event) {\n      event.preventDefault();\n      if (this.validate()) this.setState({ previewing: true });\n    }\n  }, {\n    key: 'rawMarkup',\n    value: function rawMarkup() {\n      var md = new _remarkable2.default();\n      var rawMarkup = md.render(this.state.comment);\n      return { __html: rawMarkup };\n    }\n  }, {\n    key: 'render_preview',\n    value: function render_preview() {\n      if (!this.state.previewing) return \"\";\n      var media_left = \"\",\n          heading_name = \"\";\n\n      // Build Gravatar.\n      var hash = (0, _md2.default)(this.state.email.toLowerCase());\n      var avatar_url = \"http://www.gravatar.com/avatar/\" + hash + \"?s=48&d=mm\";\n      var avatar_img = _react2.default.createElement('img', { src: avatar_url, height: '48', width: '48' });\n\n      if (this.state.url) {\n        media_left = _react2.default.createElement(\n          'a',\n          { href: this.state.url },\n          avatar_img\n        );\n        heading_name = _react2.default.createElement(\n          'a',\n          { href: this.state.url, target: '_new' },\n          this.state.name\n        );\n      } else {\n        media_left = avatar_img;\n        if (this.props.is_authenticated) heading_name = this.props.current_user.split(\":\")[1];else heading_name = this.state.name;\n      }\n\n      var div_cssc = \"\",\n          div_style = {},\n          hr_line = _react2.default.createElement('hr', null);\n      var label = \"\";\n      var header_text = _django2.default.gettext(\"Your comment in preview\");\n      var header = _react2.default.createElement(\n        'h5',\n        { className: 'text-center' },\n        header_text\n      );\n      if (this.state.reply_to > 0) {\n        div_cssc = \"well well-sm\";\n        div_style = { marginTop: \"1em\" };\n        header = \"\";\n        label = _react2.default.createElement(\n          'div',\n          { className: 'label label-info' },\n          'preview'\n        );\n        hr_line = \"\";\n      }\n      var nowtext = _django2.default.gettext(\"Now\");\n      return _react2.default.createElement(\n        'div',\n        { className: div_cssc, style: div_style },\n        header,\n        _react2.default.createElement(\n          'div',\n          { className: 'media' },\n          _react2.default.createElement(\n            'div',\n            { className: 'media-left' },\n            media_left\n          ),\n          _react2.default.createElement(\n            'div',\n            { className: 'media-body' },\n            _react2.default.createElement(\n              'h6',\n              { className: 'media-heading' },\n              nowtext,\n              '\\xA0-\\xA0',\n              heading_name,\n              '\\xA0\\xA0',\n              label\n            ),\n            _react2.default.createElement('div', { className: 'preview',\n              dangerouslySetInnerHTML: this.rawMarkup() })\n          )\n        ),\n        hr_line\n      );\n    }\n  }, {\n    key: 'render_form',\n    value: function render_form() {\n      var comment = this.render_field_comment();\n      var name = this.render_field_name();\n      var mail = this.render_field_email();\n      var url = this.render_field_url();\n      var followup = this.render_field_followup();\n      var btn_submit_class = \"btn btn-primary\",\n          btn_preview_class = \"btn btn-default\",\n          group_style = {};\n      if (this.state.reply_to != 0) {\n        btn_submit_class += \" btn-sm\";\n        btn_preview_class += \" btn-sm\";\n        group_style = { marginBottom: \"0px\" };\n      }\n      var btn_label_preview = _django2.default.gettext(\"preview\");\n      var btn_label_send = _django2.default.gettext(\"send\");\n\n      return _react2.default.createElement(\n        'form',\n        { method: 'POST', onSubmit: this.handle_submit,\n          className: 'form-horizontal' },\n        _react2.default.createElement('input', { type: 'hidden', name: 'content_type',\n          value: this.props.form.content_type }),\n        _react2.default.createElement('input', { type: 'hidden', name: 'object_pk',\n          value: this.props.form.object_pk }),\n        _react2.default.createElement('input', { type: 'hidden', name: 'timestamp',\n          value: this.props.form.timestamp }),\n        _react2.default.createElement('input', { type: 'hidden', name: 'security_hash',\n          value: this.props.form.security_hash }),\n        _react2.default.createElement('input', { type: 'hidden', name: 'reply_to',\n          value: this.state.reply_to }),\n        _react2.default.createElement(\n          'fieldset',\n          null,\n          _react2.default.createElement(\n            'div',\n            { style: { display: 'none' } },\n            _react2.default.createElement('input', { type: 'text', name: 'honeypot', value: '' })\n          ),\n          comment,\n          ' ',\n          name,\n          ' ',\n          mail,\n          ' ',\n          url,\n          ' ',\n          followup\n        ),\n        _react2.default.createElement(\n          'div',\n          { className: 'form-group', style: group_style },\n          _react2.default.createElement(\n            'div',\n            { className: 'col-lg-offset-3 col-md-offset-3 col-lg-7 col-md-7' },\n            _react2.default.createElement('input', { type: 'submit', name: 'post', value: btn_label_send,\n              className: btn_submit_class }),\n            '\\xA0',\n            _react2.default.createElement('input', { type: 'button', name: 'preview', value: btn_label_preview,\n              className: btn_preview_class,\n              onClick: this.handle_preview })\n          )\n        )\n      );\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var preview = this.render_preview();\n      var header = \"\";\n      var div_class = \"well well-sm\";\n      var label = _django2.default.gettext(\"Post your comment\");\n      if (this.state.reply_to == 0) {\n        header = _react2.default.createElement(\n          'h4',\n          { className: 'text-center' },\n          label\n        );\n        div_class = \"well well-lg\";\n      }\n      var alert_div = \"\";\n      if (this.state.alert.message) {\n        alert_div = _react2.default.createElement(\n          'div',\n          { className: this.state.alert.cssc },\n          this.state.alert.message\n        );\n      }\n      var form = this.render_form();\n\n      return _react2.default.createElement(\n        'div',\n        { className: 'comment' },\n        preview,\n        header,\n        alert_div,\n        _react2.default.createElement(\n          'div',\n          { className: div_class },\n          form\n        )\n      );\n    }\n  }]);\n\n  return CommentForm;\n}(_react2.default.Component);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZGphbmdvX2NvbW1lbnRzX3h0ZC9zdGF0aWMvZGphbmdvX2NvbW1lbnRzX3h0ZC9qcy9zcmMvY29tbWVudGZvcm0uanN4P2IxNzEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcbmltcG9ydCBkamFuZ28gZnJvbSAnZGphbmdvJztcblxuaW1wb3J0IG1kNSBmcm9tICdtZDUnO1xuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBSZWFjdERPTSBmcm9tICdyZWFjdC1kb20nO1xuaW1wb3J0IFJlbWFya2FibGUgZnJvbSAncmVtYXJrYWJsZSc7XG5cbmltcG9ydCAqIGFzIGxpYiBmcm9tICcuL2xpYi5qcyc7XG5cblxuZXhwb3J0IGNsYXNzIENvbW1lbnRGb3JtIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIG5hbWU6ICcnLCBlbWFpbDogJycsIHVybDogJycsIGZvbGxvd3VwOiBmYWxzZSwgY29tbWVudDogJycsXG4gICAgICByZXBseV90bzogdGhpcy5wcm9wcy5yZXBseV90byB8fCAwLFxuICAgICAgdmlzaXRlZDoge25hbWU6IGZhbHNlLCBlbWFpbDogZmFsc2UsIGNvbW1lbnQ6IGZhbHNlfSxcbiAgICAgIGVycm9yczoge25hbWU6IGZhbHNlLCBlbWFpbDogZmFsc2UsIGNvbW1lbnQ6IGZhbHNlfSxcbiAgICAgIHByZXZpZXdpbmc6IGZhbHNlLFxuICAgICAgYWxlcnQ6IHttZXNzYWdlOiAnJywgY3NzYzogJyd9XG4gICAgfTtcbiAgICB0aGlzLmhhbmRsZV9pbnB1dF9jaGFuZ2UgPSB0aGlzLmhhbmRsZV9pbnB1dF9jaGFuZ2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLmhhbmRsZV9ibHVyID0gdGhpcy5oYW5kbGVfYmx1ci5iaW5kKHRoaXMpO1xuICAgIHRoaXMuaGFuZGxlX3N1Ym1pdCA9IHRoaXMuaGFuZGxlX3N1Ym1pdC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuaGFuZGxlX3ByZXZpZXcgPSB0aGlzLmhhbmRsZV9wcmV2aWV3LmJpbmQodGhpcyk7XG4gICAgdGhpcy5yZXNldF9mb3JtID0gdGhpcy5yZXNldF9mb3JtLmJpbmQodGhpcyk7XG4gICAgdGhpcy5maGVscCA9IDxzcGFuIGNsYXNzTmFtZT1cImhlbHAtYmxvY2tcIj5UaGlzIGZpZWxkIGlzIHJlcXVpcmVkLjwvc3Bhbj47XG4gIH1cblxuICBoYW5kbGVfaW5wdXRfY2hhbmdlKGV2ZW50KSB7XG4gICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuICAgIGNvbnN0IHZhbHVlID0gdGFyZ2V0LnR5cGUgPT09ICdjaGVja2JveCcgPyB0YXJnZXQuY2hlY2tlZCA6IHRhcmdldC52YWx1ZTtcbiAgICBjb25zdCBpbmFtZSA9IHRhcmdldC5uYW1lO1xuXG4gICAgdGhpcy5zZXRTdGF0ZSh7W2luYW1lXTogdmFsdWV9KTtcbiAgfVxuXG4gIGhhbmRsZV9ibHVyKGZpZWxkKSB7XG4gICAgZnVuY3Rpb24gaGFuZGxlcihldmVudCkge1xuICAgICAgdmFyIHZpc2l0ZWQgPSB0aGlzLnN0YXRlLnZpc2l0ZWQ7XG4gICAgICB2aXNpdGVkW2ZpZWxkXSA9IHRydWU7XG4gICAgICB0aGlzLnNldFN0YXRlKHt2aXNpdGVkOiB2aXNpdGVkfSk7XG4gICAgfTtcbiAgICByZXR1cm4gaGFuZGxlci5iaW5kKHRoaXMpO1xuICB9XG5cbiAgdmFsaWRhdGUoKSB7XG4gICAgdmFyIGVycm9ycyA9IHRoaXMuc3RhdGUuZXJyb3JzO1xuXG4gICAgaWYoIXRoaXMuc3RhdGUuY29tbWVudC5sZW5ndGgpXG4gICAgICBlcnJvcnMuY29tbWVudCA9IHRydWU7XG4gICAgZWxzZSBlcnJvcnMuY29tbWVudCA9IGZhbHNlO1xuICAgIGlmKCF0aGlzLnByb3BzLmlzX2F1dGhlbnRpY2F0ZWQpIHtcbiAgICAgIGlmKCF0aGlzLnN0YXRlLm5hbWUubGVuZ3RoKVxuICAgICAgICBlcnJvcnMubmFtZSA9IHRydWU7XG4gICAgICBlbHNlIGVycm9ycy5uYW1lID0gZmFsc2U7XG4gICAgICBpZigvXFxTK0BcXFMrXFwuXFxTKy8udGVzdCh0aGlzLnN0YXRlLmVtYWlsKSlcbiAgICAgICAgZXJyb3JzLmVtYWlsID0gZmFsc2U7XG4gICAgICBlbHNlIGVycm9ycy5lbWFpbCA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVycm9ycy5uYW1lID0gZmFsc2U7XG4gICAgICBlcnJvcnMuZW1haWwgPSBmYWxzZTtcbiAgICB9XG4gICAgdGhpcy5zZXRTdGF0ZSh7ZXJyb3JzOiBlcnJvcnN9KTtcblxuICAgIGlmKHRoaXMuc3RhdGUuZXJyb3JzLmNvbW1lbnQgfHxcbiAgICAgICB0aGlzLnN0YXRlLmVycm9ycy5uYW1lIHx8XG4gICAgICAgdGhpcy5zdGF0ZS5lcnJvcnMuZW1haWwpXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgZWxzZSByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIHJlbmRlcl9maWVsZF9jb21tZW50KCkge1xuICAgIGxldCBjc3NjID0gXCJmb3JtLWdyb3VwIFwiLCBoZWxwID0gXCJcIjtcbiAgICBpZiAodGhpcy5zdGF0ZS5lcnJvcnMuY29tbWVudCkge1xuICAgICAgY3NzYyArPSAodGhpcy5zdGF0ZS5lcnJvcnMuY29tbWVudCA/IFwiaGFzLWVycm9yXCIgOiBcIlwiKTtcbiAgICAgIGhlbHAgPSB0aGlzLmZoZWxwO1xuICAgIH1cbiAgICB2YXIgcGxhY2Vob2xkZXIgPSBkamFuZ28uZ2V0dGV4dChcIllvdXIgY29tbWVudFwiKTtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9e2Nzc2N9PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbC1sZy1vZmZzZXQtMSBjb2wtbWQtb2Zmc2V0LTEgY29sLWxnLTEwIGNvbC1tZC0xMFwiPlxuICAgICAgICAgIDx0ZXh0YXJlYSByZXF1aXJlZCBuYW1lPVwiY29tbWVudFwiIGlkPVwiaWRfY29tbWVudFwiXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXtwbGFjZWhvbGRlcn0gbWF4TGVuZ3RoPVwiMzAwMFwiXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZvcm0tY29udHJvbFwiIHZhbHVlPXt0aGlzLnN0YXRlLmNvbW1lbnR9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLmhhbmRsZV9pbnB1dF9jaGFuZ2V9XG4gICAgICAgICAgICAgICAgICAgIG9uQmx1cj17dGhpcy5oYW5kbGVfYmx1cignY29tbWVudCcpfSAvPlxuICAgICAgICAgIHtoZWxwfVxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cblxuICByZW5kZXJfZmllbGRfbmFtZSgpIHtcbiAgICBpZih0aGlzLnByb3BzLmlzX2F1dGhlbnRpY2F0ZWQpXG4gICAgICByZXR1cm4gXCJcIjtcbiAgICBsZXQgZGl2X2Nzc2MgPSBcImZvcm0tZ3JvdXBcIiwgaW5wdXRfY3NzYyA9IFwiZm9ybS1jb250cm9sXCIsIGhlbHAgPSBcIlwiO1xuICAgIGlmICh0aGlzLnN0YXRlLnJlcGx5X3RvID4gMCkge1xuICAgICAgZGl2X2Nzc2MgKz0gXCIgZm9ybS1ncm91cC1zbVwiO1xuICAgICAgaW5wdXRfY3NzYyArPSBcIiBpbnB1dC1zbVwiO1xuICAgIH1cbiAgICBpZiAodGhpcy5zdGF0ZS5lcnJvcnMubmFtZSkge1xuICAgICAgZGl2X2Nzc2MgKz0gXCIgaGFzLWVycm9yXCI7XG4gICAgICBoZWxwID0gdGhpcy5maGVscDtcbiAgICB9XG4gICAgdmFyIHBsYWNlaG9sZGVyID0gZGphbmdvLmdldHRleHQoJ25hbWUnKTtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9e2Rpdl9jc3NjfT5cbiAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJpZF9uYW1lXCIgY2xhc3NOYW1lPVwiY29udHJvbC1sYWJlbCBjb2wtbGctMyBjb2wtbWQtM1wiPlxuICAgICAgICAgIHtkamFuZ28uZ2V0dGV4dChcIk5hbWVcIil9XG4gICAgICAgIDwvbGFiZWw+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29sLWxnLTcgY29sLW1kLTdcIj5cbiAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBuYW1lPVwibmFtZVwiIHJlcXVpcmVkIGlkPVwiaWRfbmFtZVwiXG4gICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLm5hbWV9IHBsYWNlaG9sZGVyPXtwbGFjZWhvbGRlcn1cbiAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuaGFuZGxlX2lucHV0X2NoYW5nZX1cbiAgICAgICAgICAgICAgICAgb25CbHVyPXt0aGlzLmhhbmRsZV9ibHVyKCduYW1lJyl9XG4gICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17aW5wdXRfY3NzY30gLz5cbiAgICAgICAgICB7aGVscH1cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyX2ZpZWxkX2VtYWlsKCkge1xuICAgIGlmKHRoaXMucHJvcHMuaXNfYXV0aGVudGljYXRlZClcbiAgICAgIHJldHVybiBcIlwiO1xuICAgIGxldCBkaXZfY3NzYyA9IFwiZm9ybS1ncm91cFwiLCBpbnB1dF9jc3NjID0gXCJmb3JtLWNvbnRyb2xcIjtcbiAgICBpZiAodGhpcy5zdGF0ZS5yZXBseV90byA+IDApIHtcbiAgICAgIGRpdl9jc3NjICs9IFwiIGZvcm0tZ3JvdXAtc21cIjtcbiAgICAgIGlucHV0X2Nzc2MgKz0gXCIgaW5wdXQtc21cIjtcbiAgICB9XG4gICAgaWYgKHRoaXMuc3RhdGUuZXJyb3JzLmVtYWlsKVxuICAgICAgZGl2X2Nzc2MgKz0gXCIgaGFzLWVycm9yXCI7XG4gICAgdmFyIHBsYWNlaG9sZGVyID0gZGphbmdvLmdldHRleHQoJ21haWwgYWRkcmVzcycpO1xuICAgIHZhciBoZWxwdGV4dCA9IGRqYW5nby5nZXR0ZXh0KCdSZXF1aXJlZCBmb3IgY29tbWVudCB2ZXJpZmljYXRpb24uJyk7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPXtkaXZfY3NzY30+XG4gICAgICAgIDxsYWJlbCBodG1sRm9yPVwiaWRfZW1haWxcIiBjbGFzc05hbWU9XCJjb250cm9sLWxhYmVsIGNvbC1sZy0zIGNvbC1tZC0zXCI+XG4gICAgICAgICAge2RqYW5nby5nZXR0ZXh0KFwiTWFpbFwiKX1cbiAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2wtbGctNyBjb2wtbWQtN1wiPlxuICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5hbWU9XCJlbWFpbFwiIHJlcXVpcmVkIGlkPVwiaWRfZW1haWxcIlxuICAgICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS5lbWFpbH0gcGxhY2Vob2xkZXI9e3BsYWNlaG9sZGVyfVxuICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5oYW5kbGVfaW5wdXRfY2hhbmdlfVxuICAgICAgICAgICAgICAgICBvbkJsdXI9e3RoaXMuaGFuZGxlX2JsdXIoJ2VtYWlsJyl9XG4gICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17aW5wdXRfY3NzY30gLz5cbiAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJoZWxwLWJsb2NrXCI+e2hlbHB0ZXh0fTwvc3Bhbj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyX2ZpZWxkX3VybCgpIHtcbiAgICBpZih0aGlzLnByb3BzLmlzX2F1dGhlbnRpY2F0ZWQpXG4gICAgICByZXR1cm4gXCJcIjtcbiAgICBsZXQgZGl2X2Nzc2MgPSBcImZvcm0tZ3JvdXBcIiwgaW5wdXRfY3NzYyA9IFwiZm9ybS1jb250cm9sXCI7XG4gICAgaWYodGhpcy5zdGF0ZS5yZXBseV90byA+IDApIHtcbiAgICAgIGRpdl9jc3NjICs9IFwiIGZvcm0tZ3JvdXAtc21cIjtcbiAgICAgIGlucHV0X2Nzc2MgKz0gXCIgaW5wdXQtc21cIjtcbiAgICB9XG4gICAgaWYodGhpcy5zdGF0ZS5lcnJvcnMudXJsKVxuICAgICAgZGl2X2Nzc2MgKz0gXCIgZm9ybS1ncm91cFwiO1xuICAgIHZhciBwbGFjZWhvbGRlciA9IGRqYW5nby5nZXR0ZXh0KFwidXJsIHlvdXIgbmFtZSBsaW5rcyB0byAob3B0aW9uYWwpXCIpO1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT17ZGl2X2Nzc2N9PlxuICAgICAgICA8bGFiZWwgaHRtbEZvcj1cImlkX3VybFwiIGNsYXNzTmFtZT1cImNvbnRyb2wtbGFiZWwgY29sLWxnLTMgY29sLW1kLTNcIj5cbiAgICAgICAgICB7ZGphbmdvLmdldHRleHQoXCJMaW5rXCIpfVxuICAgICAgICA8L2xhYmVsPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbC1sZy03IGNvbC1tZC03XCI+XG4gICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmFtZT1cInVybFwiIGlkPVwiaWRfdXJsXCIgdmFsdWU9e3RoaXMuc3RhdGUudXJsfVxuICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17cGxhY2Vob2xkZXJ9XG4gICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLmhhbmRsZV9pbnB1dF9jaGFuZ2V9XG4gICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17aW5wdXRfY3NzY30gLz5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyX2ZpZWxkX2ZvbGxvd3VwKCkge1xuICAgIGxldCBkaXZfY3NzYyA9IFwiY2hlY2tib3hcIjtcbiAgICBpZih0aGlzLnN0YXRlLnJlcGx5X3RvID4gMClcbiAgICAgIGRpdl9jc3NjICs9IFwiIHNtYWxsXCI7XG4gICAgdmFyIGxhYmVsID0gZGphbmdvLmdldHRleHQoXCJOb3RpZnkgbWUgYWJvdXQgZm9sbG93LXVwIGNvbW1lbnRzXCIpO1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvcm0tZ3JvdXBcIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2wtbGctb2Zmc2V0LTMgY29sLW1kLW9mZnNldC0zIGNvbC1sZy03IGNvbC1tZC03XCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2Rpdl9jc3NjfT5cbiAgICAgICAgICAgIDxsYWJlbCBodG1sRm9yPVwiaWRfZm9sbG93dXBcIj5cbiAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGNoZWNrZWQ9e3RoaXMuc3RhdGUuZm9sbG93dXB9XG4gICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5oYW5kbGVfaW5wdXRfY2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAgbmFtZT1cImZvbGxvd3VwXCIgaWQ9XCJpZF9mb2xsb3d1cFwiIC8+XG4gICAgICAgICAgICAgICZuYnNwO3tsYWJlbH1cbiAgICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxuXG4gIHJlc2V0X2Zvcm0oKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBuYW1lOiAnJywgZW1haWw6ICcnLCB1cmw6ICcnLCBmb2xsb3d1cDogZmFsc2UsIGNvbW1lbnQ6ICcnLFxuICAgICAgdmlzaXRlZDoge25hbWU6IGZhbHNlLCBlbWFpbDogZmFsc2UsIGNvbW1lbnQ6IGZhbHNlfSxcbiAgICAgIGVycm9yczoge25hbWU6IGZhbHNlLCBlbWFpbDogZmFsc2UsIGNvbW1lbnQ6IGZhbHNlfVxuICAgIH0pO1xuICB9XG4gIFxuICBoYW5kbGVfc3VibWl0KGV2ZW50KSB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBpZighdGhpcy52YWxpZGF0ZSgpKVxuICAgICAgcmV0dXJuO1xuXG4gICAgY29uc3QgZGF0YSA9IHtcbiAgICAgIGNvbnRlbnRfdHlwZTogdGhpcy5wcm9wcy5mb3JtLmNvbnRlbnRfdHlwZSxcbiAgICAgIG9iamVjdF9wazogdGhpcy5wcm9wcy5mb3JtLm9iamVjdF9wayxcbiAgICAgIHRpbWVzdGFtcDogdGhpcy5wcm9wcy5mb3JtLnRpbWVzdGFtcCxcbiAgICAgIHNlY3VyaXR5X2hhc2g6IHRoaXMucHJvcHMuZm9ybS5zZWN1cml0eV9oYXNoLFxuICAgICAgaG9uZXlwb3Q6ICcnLFxuICAgICAgY29tbWVudDogdGhpcy5zdGF0ZS5jb21tZW50LFxuICAgICAgbmFtZTogdGhpcy5zdGF0ZS5uYW1lLFxuICAgICAgZW1haWw6IHRoaXMuc3RhdGUuZW1haWwsXG4gICAgICB1cmw6IHRoaXMuc3RhdGUudXJsLFxuICAgICAgZm9sbG93dXA6IHRoaXMuc3RhdGUuZm9sbG93dXAsXG4gICAgICByZXBseV90bzogdGhpcy5zdGF0ZS5yZXBseV90b1xuICAgIH07XG4gICAgY29uc3QgY3NzYyA9IFwiYWxlcnQgYWxlcnQtXCI7XG4gICAgdmFyIG1zZ18yMDIgPSBkamFuZ28uZ2V0dGV4dChcIllvdXIgY29tbWVudCB3aWxsIGJlIHJldmlld2VkLiBUaGFuayB5b3VyIGZvciB5b3VyIHBhdGllbmNlLlwiKTtcbiAgICB2YXIgbXNnXzIwNCA9IGRqYW5nby5nZXR0ZXh0KFwiVGhhbmsgeW91LCBhIGNvbW1lbnQgY29uZmlybWF0aW9uIHJlcXVlc3QgaGFzIGJlZW4gc2VudCBieSBtYWlsLlwiKTtcbiAgICB2YXIgbXNnXzQwMyA9IGRqYW5nby5nZXR0ZXh0KFwiU29ycnksIHlvdXIgY29tbWVudCBoYXMgYmVlbiByZWplY3RlZC5cIik7XG4gICAgY29uc3QgbWVzc2FnZSA9IHtcbiAgICAgIDIwMjogbXNnXzIwMixcbiAgICAgIDIwNDogbXNnXzIwNCxcbiAgICAgIDQwMzogbXNnXzQwM1xuICAgIH07XG4gICAgXG4gICAgJC5hamF4KHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgdXJsOiB0aGlzLnByb3BzLnNlbmRfdXJsLFxuICAgICAgZGF0YTogZGF0YSxcbiAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICBjYWNoZTogZmFsc2UsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhLCB0ZXh0U3RhdHVzLCB4aHIpIHtcbiAgICAgICAgaWYoWzIwMSwgMjAyLCAyMDQsIDQwM10uaW5kZXhPZih4aHIuc3RhdHVzKSA+IC0xKSB7XG4gICAgICAgICAgdmFyIGNzc19jbGFzcyA9IFwiXCI7XG4gICAgICAgICAgaWYoeGhyLnN0YXR1cyA9PSA0MDMpXG4gICAgICAgICAgICBjc3NfY2xhc3MgPSBjc3NjICsgXCJkYW5nZXJcIjtcbiAgICAgICAgICBlbHNlIGNzc19jbGFzcyA9IGNzc2MgKyBcImluZm9cIjtcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKHthbGVydDoge21lc3NhZ2U6IG1lc3NhZ2VbeGhyLnN0YXR1c10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjc3NjOiBjc3NfY2xhc3N9LFxuICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdpbmc6IGZhbHNlfSk7XG4gICAgICAgICAgdGhpcy5yZXNldF9mb3JtKCk7XG4gICAgICAgICAgdGhpcy5wcm9wcy5vbl9jb21tZW50X2NyZWF0ZWQoKTtcbiAgICAgICAgfVxuICAgICAgfS5iaW5kKHRoaXMpLFxuICAgICAgZXJyb3I6IGZ1bmN0aW9uKHhociwgc3RhdHVzLCBlcnIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcih0aGlzLnByb3BzLnNlbmRfdXJsLCBzdGF0dXMsIGVyci50b1N0cmluZygpKTtcbiAgICAgIH0uYmluZCh0aGlzKVxuICAgIH0pO1xuICB9XG4gIFxuICBoYW5kbGVfcHJldmlldyhldmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgaWYodGhpcy52YWxpZGF0ZSgpKVxuICAgICAgdGhpcy5zZXRTdGF0ZSh7cHJldmlld2luZzogdHJ1ZX0pO1xuICB9XG5cbiAgcmF3TWFya3VwKCkge1xuICAgIHZhciBtZCA9IG5ldyBSZW1hcmthYmxlKCk7XG4gICAgY29uc3QgcmF3TWFya3VwID0gbWQucmVuZGVyKHRoaXMuc3RhdGUuY29tbWVudCk7XG4gICAgcmV0dXJuIHsgX19odG1sOiByYXdNYXJrdXAgfTtcbiAgfVxuICBcbiAgcmVuZGVyX3ByZXZpZXcoKSB7XG4gICAgaWYoIXRoaXMuc3RhdGUucHJldmlld2luZylcbiAgICAgIHJldHVybiBcIlwiO1xuICAgIHZhciBtZWRpYV9sZWZ0ID0gXCJcIiwgaGVhZGluZ19uYW1lID0gXCJcIjtcblxuICAgIC8vIEJ1aWxkIEdyYXZhdGFyLlxuICAgIGNvbnN0IGhhc2ggPSBtZDUodGhpcy5zdGF0ZS5lbWFpbC50b0xvd2VyQ2FzZSgpKTtcbiAgICBjb25zdCBhdmF0YXJfdXJsID0gXCJodHRwOi8vd3d3LmdyYXZhdGFyLmNvbS9hdmF0YXIvXCIraGFzaCtcIj9zPTQ4JmQ9bW1cIjtcbiAgICBjb25zdCBhdmF0YXJfaW1nID0gPGltZyBzcmM9e2F2YXRhcl91cmx9IGhlaWdodD1cIjQ4XCIgd2lkdGg9XCI0OFwiLz47XG4gICAgXG4gICAgaWYodGhpcy5zdGF0ZS51cmwpIHtcbiAgICAgIG1lZGlhX2xlZnQgPSA8YSBocmVmPXt0aGlzLnN0YXRlLnVybH0+e2F2YXRhcl9pbWd9PC9hPjtcbiAgICAgIGhlYWRpbmdfbmFtZSA9ICg8YSBocmVmPXt0aGlzLnN0YXRlLnVybH0gdGFyZ2V0PVwiX25ld1wiPlxuICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLm5hbWV9PC9hPik7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1lZGlhX2xlZnQgPSBhdmF0YXJfaW1nO1xuICAgICAgaWYodGhpcy5wcm9wcy5pc19hdXRoZW50aWNhdGVkKVxuICAgICAgICBoZWFkaW5nX25hbWUgPSB0aGlzLnByb3BzLmN1cnJlbnRfdXNlci5zcGxpdChcIjpcIilbMV07XG4gICAgICBlbHNlIGhlYWRpbmdfbmFtZSA9IHRoaXMuc3RhdGUubmFtZTtcbiAgICB9XG5cbiAgICBsZXQgZGl2X2Nzc2MgPSBcIlwiLCBkaXZfc3R5bGUgPSB7fSwgaHJfbGluZSA9IDxoci8+O1xuICAgIGxldCBsYWJlbCA9IFwiXCI7XG4gICAgdmFyIGhlYWRlcl90ZXh0ID0gZGphbmdvLmdldHRleHQoXCJZb3VyIGNvbW1lbnQgaW4gcHJldmlld1wiKTtcbiAgICBsZXQgaGVhZGVyID0gPGg1IGNsYXNzTmFtZT1cInRleHQtY2VudGVyXCI+e2hlYWRlcl90ZXh0fTwvaDU+O1xuICAgIGlmKHRoaXMuc3RhdGUucmVwbHlfdG8gPiAwKSB7XG4gICAgICBkaXZfY3NzYyA9IFwid2VsbCB3ZWxsLXNtXCI7XG4gICAgICBkaXZfc3R5bGUgPSB7bWFyZ2luVG9wOiBcIjFlbVwifTtcbiAgICAgIGhlYWRlciA9IFwiXCI7XG4gICAgICBsYWJlbCA9IDxkaXYgY2xhc3NOYW1lPVwibGFiZWwgbGFiZWwtaW5mb1wiPnByZXZpZXc8L2Rpdj47XG4gICAgICBocl9saW5lID0gXCJcIjtcbiAgICB9XG4gICAgdmFyIG5vd3RleHQgPSBkamFuZ28uZ2V0dGV4dChcIk5vd1wiKTtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9e2Rpdl9jc3NjfSBzdHlsZT17ZGl2X3N0eWxlfT5cbiAgICAgICAge2hlYWRlcn1cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtZWRpYVwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWVkaWEtbGVmdFwiPnttZWRpYV9sZWZ0fTwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWVkaWEtYm9keVwiPlxuICAgICAgICAgICAgPGg2IGNsYXNzTmFtZT1cIm1lZGlhLWhlYWRpbmdcIj5cbiAgICAgICAgICAgICAge25vd3RleHR9Jm5ic3A7LSZuYnNwO3toZWFkaW5nX25hbWV9Jm5ic3A7Jm5ic3A7e2xhYmVsfVxuICAgICAgICAgICAgPC9oNj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicHJldmlld1wiXG4gICAgICAgICAgICAgICAgIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt0aGlzLnJhd01hcmt1cCgpfSAvPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAge2hyX2xpbmV9XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyX2Zvcm0oKSB7XG4gICAgbGV0IGNvbW1lbnQgPSB0aGlzLnJlbmRlcl9maWVsZF9jb21tZW50KCk7XG4gICAgbGV0IG5hbWUgPSB0aGlzLnJlbmRlcl9maWVsZF9uYW1lKCk7XG4gICAgbGV0IG1haWwgPSB0aGlzLnJlbmRlcl9maWVsZF9lbWFpbCgpO1xuICAgIGxldCB1cmwgPSB0aGlzLnJlbmRlcl9maWVsZF91cmwoKTtcbiAgICBsZXQgZm9sbG93dXAgPSB0aGlzLnJlbmRlcl9maWVsZF9mb2xsb3d1cCgpO1xuICAgIGxldCBidG5fc3VibWl0X2NsYXNzID0gXCJidG4gYnRuLXByaW1hcnlcIixcbiAgICAgICAgYnRuX3ByZXZpZXdfY2xhc3MgPSBcImJ0biBidG4tZGVmYXVsdFwiLFxuICAgICAgICBncm91cF9zdHlsZSA9IHt9O1xuICAgIGlmKHRoaXMuc3RhdGUucmVwbHlfdG8gIT0gMCkge1xuICAgICAgYnRuX3N1Ym1pdF9jbGFzcyArPSBcIiBidG4tc21cIjtcbiAgICAgIGJ0bl9wcmV2aWV3X2NsYXNzICs9IFwiIGJ0bi1zbVwiO1xuICAgICAgZ3JvdXBfc3R5bGUgPSB7bWFyZ2luQm90dG9tOiBcIjBweFwifTtcbiAgICB9XG4gICAgdmFyIGJ0bl9sYWJlbF9wcmV2aWV3ID0gZGphbmdvLmdldHRleHQoXCJwcmV2aWV3XCIpO1xuICAgIHZhciBidG5fbGFiZWxfc2VuZCA9IGRqYW5nby5nZXR0ZXh0KFwic2VuZFwiKTtcbiAgICBcbiAgICByZXR1cm4gKFxuICAgICAgPGZvcm0gbWV0aG9kPVwiUE9TVFwiIG9uU3VibWl0PXt0aGlzLmhhbmRsZV9zdWJtaXR9XG4gICAgICAgICAgICBjbGFzc05hbWU9XCJmb3JtLWhvcml6b250YWxcIj5cbiAgICAgICAgPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBuYW1lPVwiY29udGVudF90eXBlXCJcbiAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnByb3BzLmZvcm0uY29udGVudF90eXBlfS8+XG4gICAgICAgIDxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgbmFtZT1cIm9iamVjdF9wa1wiXG4gICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5wcm9wcy5mb3JtLm9iamVjdF9wa30vPlxuICAgICAgICA8aW5wdXQgdHlwZT1cImhpZGRlblwiIG5hbWU9XCJ0aW1lc3RhbXBcIlxuICAgICAgICAgICAgICAgdmFsdWU9e3RoaXMucHJvcHMuZm9ybS50aW1lc3RhbXB9Lz5cbiAgICAgICAgPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBuYW1lPVwic2VjdXJpdHlfaGFzaFwiXG4gICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5wcm9wcy5mb3JtLnNlY3VyaXR5X2hhc2h9Lz5cbiAgICAgICAgPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBuYW1lPVwicmVwbHlfdG9cIlxuICAgICAgICAgICAgICAgdmFsdWU9e3RoaXMuc3RhdGUucmVwbHlfdG99Lz5cbiAgICAgICAgPGZpZWxkc2V0PlxuICAgICAgICAgIDxkaXYgc3R5bGU9e3tkaXNwbGF5Oidub25lJ319PlxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmFtZT1cImhvbmV5cG90XCIgdmFsdWU9XCJcIi8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAge2NvbW1lbnR9IHtuYW1lfSB7bWFpbH0ge3VybH0ge2ZvbGxvd3VwfVxuICAgICAgICA8L2ZpZWxkc2V0PlxuICAgICAgICBcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmb3JtLWdyb3VwXCIgc3R5bGU9e2dyb3VwX3N0eWxlfT5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbC1sZy1vZmZzZXQtMyBjb2wtbWQtb2Zmc2V0LTMgY29sLWxnLTcgY29sLW1kLTdcIj5cbiAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwic3VibWl0XCIgbmFtZT1cInBvc3RcIiB2YWx1ZT17YnRuX2xhYmVsX3NlbmR9XG4gICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtidG5fc3VibWl0X2NsYXNzfSAvPiZuYnNwO1xuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJidXR0b25cIiBuYW1lPVwicHJldmlld1wiIHZhbHVlPXtidG5fbGFiZWxfcHJldmlld31cbiAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2J0bl9wcmV2aWV3X2NsYXNzfVxuICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuaGFuZGxlX3ByZXZpZXd9IC8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9mb3JtPlxuICAgICk7XG4gIH1cbiAgXG4gIHJlbmRlcigpIHtcbiAgICBsZXQgcHJldmlldyA9IHRoaXMucmVuZGVyX3ByZXZpZXcoKTtcbiAgICBsZXQgaGVhZGVyID0gXCJcIjtcbiAgICBsZXQgZGl2X2NsYXNzID0gXCJ3ZWxsIHdlbGwtc21cIjtcbiAgICB2YXIgbGFiZWwgPSBkamFuZ28uZ2V0dGV4dChcIlBvc3QgeW91ciBjb21tZW50XCIpO1xuICAgIGlmKHRoaXMuc3RhdGUucmVwbHlfdG8gPT0gMCkge1xuICAgICAgaGVhZGVyID0gPGg0IGNsYXNzTmFtZT1cInRleHQtY2VudGVyXCI+e2xhYmVsfTwvaDQ+O1xuICAgICAgZGl2X2NsYXNzID0gXCJ3ZWxsIHdlbGwtbGdcIjtcbiAgICB9XG4gICAgbGV0IGFsZXJ0X2RpdiA9IFwiXCI7XG4gICAgaWYodGhpcy5zdGF0ZS5hbGVydC5tZXNzYWdlKSB7XG4gICAgICBhbGVydF9kaXYgPSAoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPXt0aGlzLnN0YXRlLmFsZXJ0LmNzc2N9PlxuICAgICAgICAgIHt0aGlzLnN0YXRlLmFsZXJ0Lm1lc3NhZ2V9XG4gICAgICAgIDwvZGl2PlxuICAgICAgKTtcbiAgICB9XG4gICAgbGV0IGZvcm0gPSB0aGlzLnJlbmRlcl9mb3JtKCk7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb21tZW50XCI+XG4gICAgICAgIHtwcmV2aWV3fVxuICAgICAgICB7aGVhZGVyfVxuICAgICAgICB7YWxlcnRfZGl2fVxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT17ZGl2X2NsYXNzfT5cbiAgICAgICAgICB7Zm9ybX1cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICAgIFxuICAgICk7XG4gIH1cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBkamFuZ29fY29tbWVudHNfeHRkL3N0YXRpYy9kamFuZ29fY29tbWVudHNfeHRkL2pzL3NyYy9jb21tZW50Zm9ybS5qc3giXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7QUFEQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FBRUE7OztBQUNBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFmQTtBQWdCQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBR0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBOzs7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFEQTtBQVdBOzs7QUFFQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBSkE7QUFjQTs7O0FBRUE7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFHQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU5BO0FBSkE7QUFjQTs7O0FBRUE7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBR0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQUpBO0FBWUE7OztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFJQTtBQUpBO0FBREE7QUFEQTtBQURBO0FBYUE7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVhBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBckJBO0FBdUJBOzs7QUFFQTtBQUNBO0FBQ0E7QUFFQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBRUE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUxBO0FBRkE7QUFVQTtBQVpBO0FBZUE7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUdBO0FBSkE7QUFJQTtBQUpBO0FBSUE7QUFKQTtBQUlBO0FBSkE7QUFJQTtBQUpBO0FBT0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUZBO0FBR0E7QUFDQTtBQUNBO0FBTEE7QUFEQTtBQW5CQTtBQThCQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFKQTtBQVVBOzs7O0FBellBIiwic291cmNlUm9vdCI6IiJ9");

/***/ }),

/***/ 61:
/* unknown exports provided */
/* all exports used */
/*!**********************************************************************!*\
  !*** ./django_comments_xtd/static/django_comments_xtd/js/src/lib.js ***!
  \**********************************************************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getCookie = getCookie;\nexports.csrfSafeMethod = csrfSafeMethod;\nexports.jquery_ajax_setup = jquery_ajax_setup;\n\nvar _jquery = __webpack_require__(/*! jquery */ 37);\n\nvar _jquery2 = _interopRequireDefault(_jquery);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction getCookie(name) {\n  var cookieValue = null;\n  if (document.cookie && document.cookie !== '') {\n    var cookies = document.cookie.split(';');\n    for (var i = 0; i < cookies.length; i++) {\n      var cookie = jQuery.trim(cookies[i]);\n      // Does this cookie string begin with the name we want?\n      if (cookie.substring(0, name.length + 1) === name + '=') {\n        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));\n        break;\n      }\n    }\n  }\n  return cookieValue;\n}\n\nfunction csrfSafeMethod(method) {\n  // these HTTP methods do not require CSRF protection\n  return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method)\n  );\n}\n\nfunction jquery_ajax_setup(csrf_cookie_name) {\n  _jquery2.default.ajaxSetup({\n    beforeSend: function beforeSend(xhr, settings) {\n      if (!csrfSafeMethod(settings.type) && !this.crossDomain) {\n        xhr.setRequestHeader(\"X-CSRFToken\", getCookie(csrf_cookie_name));\n      }\n    }\n  });\n}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZGphbmdvX2NvbW1lbnRzX3h0ZC9zdGF0aWMvZGphbmdvX2NvbW1lbnRzX3h0ZC9qcy9zcmMvbGliLmpzPzkwNjQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcblxuZXhwb3J0IGZ1bmN0aW9uIGdldENvb2tpZShuYW1lKSB7XG4gIHZhciBjb29raWVWYWx1ZSA9IG51bGw7XG4gIGlmIChkb2N1bWVudC5jb29raWUgJiYgZG9jdW1lbnQuY29va2llICE9PSAnJykge1xuICAgIHZhciBjb29raWVzID0gZG9jdW1lbnQuY29va2llLnNwbGl0KCc7Jyk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb29raWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgY29va2llID0galF1ZXJ5LnRyaW0oY29va2llc1tpXSk7XG4gICAgICAvLyBEb2VzIHRoaXMgY29va2llIHN0cmluZyBiZWdpbiB3aXRoIHRoZSBuYW1lIHdlIHdhbnQ/XG4gICAgICBpZiAoY29va2llLnN1YnN0cmluZygwLCBuYW1lLmxlbmd0aCArIDEpID09PSAobmFtZSArICc9JykpIHtcbiAgICAgICAgY29va2llVmFsdWUgPSBkZWNvZGVVUklDb21wb25lbnQoY29va2llLnN1YnN0cmluZyhuYW1lLmxlbmd0aCArIDEpKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBjb29raWVWYWx1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNzcmZTYWZlTWV0aG9kKG1ldGhvZCkge1xuICAvLyB0aGVzZSBIVFRQIG1ldGhvZHMgZG8gbm90IHJlcXVpcmUgQ1NSRiBwcm90ZWN0aW9uXG4gIHJldHVybiAoL14oR0VUfEhFQUR8T1BUSU9OU3xUUkFDRSkkLy50ZXN0KG1ldGhvZCkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24ganF1ZXJ5X2FqYXhfc2V0dXAoY3NyZl9jb29raWVfbmFtZSkge1xuICAkLmFqYXhTZXR1cCh7XG4gICAgYmVmb3JlU2VuZDogZnVuY3Rpb24oeGhyLCBzZXR0aW5ncykge1xuICAgICAgaWYgKCFjc3JmU2FmZU1ldGhvZChzZXR0aW5ncy50eXBlKSAmJiAhdGhpcy5jcm9zc0RvbWFpbikge1xuICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIlgtQ1NSRlRva2VuXCIsIGdldENvb2tpZShjc3JmX2Nvb2tpZV9uYW1lKSk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBkamFuZ29fY29tbWVudHNfeHRkL3N0YXRpYy9kamFuZ29fY29tbWVudHNfeHRkL2pzL3NyYy9saWIuanMiXSwibWFwcGluZ3MiOiI7Ozs7O0FBRUE7QUFnQkE7QUFLQTtBQUNBO0FBeEJBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ }),

/***/ 98:
/* unknown exports provided */
/* all exports used */
/*!******************************************************************************!*\
  !*** ./django_comments_xtd/static/django_comments_xtd/js/src/commentbox.jsx ***!
  \******************************************************************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CommentBox = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _jquery = __webpack_require__(/*! jquery */ 37);\n\nvar _jquery2 = _interopRequireDefault(_jquery);\n\nvar _react = __webpack_require__(/*! react */ 19);\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = __webpack_require__(/*! react-dom */ 18);\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _lib = __webpack_require__(/*! ./lib.js */ 61);\n\nvar lib = _interopRequireWildcard(_lib);\n\nvar _django = __webpack_require__(/*! django */ 58);\n\nvar _django2 = _interopRequireDefault(_django);\n\nvar _comment = __webpack_require__(/*! ./comment.jsx */ 100);\n\nvar _commentform = __webpack_require__(/*! ./commentform.jsx */ 60);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar CommentBox = exports.CommentBox = function (_React$Component) {\n  _inherits(CommentBox, _React$Component);\n\n  function CommentBox(props) {\n    _classCallCheck(this, CommentBox);\n\n    var _this = _possibleConstructorReturn(this, (CommentBox.__proto__ || Object.getPrototypeOf(CommentBox)).call(this, props));\n\n    lib.jquery_ajax_setup('csrftoken');\n    _this.state = {\n      previewing: false,\n      preview: { name: '', email: '', url: '', comment: '' },\n      tree: [], cids: [], newcids: [], counter: _this.props.comment_count\n    };\n    _this.handle_comment_created = _this.handle_comment_created.bind(_this);\n    _this.handle_preview = _this.handle_preview.bind(_this);\n    _this.handle_update = _this.handle_update.bind(_this);\n    return _this;\n  }\n\n  _createClass(CommentBox, [{\n    key: 'handle_comment_created',\n    value: function handle_comment_created() {\n      this.load_comments();\n    }\n  }, {\n    key: 'handle_preview',\n    value: function handle_preview(name, email, url, comment) {\n      this.setState({\n        preview: { name: name, email: email, url: url, comment: comment },\n        previewing: true\n      });\n    }\n  }, {\n    key: 'handle_update',\n    value: function handle_update(event) {\n      event.preventDefault();\n      this.load_comments();\n    }\n  }, {\n    key: 'reset_preview',\n    value: function reset_preview() {\n      this.setState({\n        preview: { name: '', email: '', url: '', comment: '' },\n        previewing: false\n      });\n    }\n  }, {\n    key: 'render_comment_counter',\n    value: function render_comment_counter() {\n      if (this.state.counter > 0) {\n        var fmts = _django2.default.ngettext(\"One comment.\", \"%s comments.\", this.state.cids.length);\n        var text = _django2.default.interpolate(fmts, [this.state.cids.length]);\n        return _react2.default.createElement(\n          'div',\n          null,\n          _react2.default.createElement(\n            'h5',\n            { className: 'text-center' },\n            text\n          ),\n          _react2.default.createElement('hr', null)\n        );\n      } else return \"\";\n    }\n  }, {\n    key: 'render_comment_form',\n    value: function render_comment_form() {\n      if (this.props.allow_comments) {\n        return _react2.default.createElement(_commentform.CommentForm, { form: this.props.form,\n          send_url: this.props.send_url,\n          current_user: this.props.current_user,\n          is_authenticated: this.props.is_authenticated,\n          on_comment_created: this.handle_comment_created });\n      } else {\n        return _react2.default.createElement(\n          'h5',\n          null,\n          'Comments are disabled for this article.'\n        );\n      }\n    }\n  }, {\n    key: 'render_update_alert',\n    value: function render_update_alert() {\n      var diff = this.state.counter - this.state.cids.length;\n      if (diff > 0) {\n        var fmts = _django2.default.ngettext(\"There is a new comment.\", \"There are %s new comments.\", diff);\n        var message = _django2.default.interpolate(fmts, [diff]);\n        return _react2.default.createElement(\n          'div',\n          { className: 'alert alert-info' },\n          message,\n          _react2.default.createElement(\n            'div',\n            { className: 'pull-right' },\n            _react2.default.createElement(\n              'button',\n              { type: 'button', className: 'btn btn-default btn-xs',\n                onClick: this.handle_update },\n              'update'\n            )\n          )\n        );\n      } else return \"\";\n    }\n  }, {\n    key: 'create_tree',\n    value: function create_tree(data) {\n      var tree = new Array();\n      var order = new Array();\n      var comments = {};\n      var children = {};\n      var incids = [],\n          curcids = [],\n          newcids = [];\n\n      function get_children(cid) {\n        return children[cid].map(function (index) {\n          if (comments[index].children == undefined) {\n            comments[index].children = get_children(index);\n          }\n          return comments[index];\n        });\n      };\n\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = data[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var item = _step.value;\n\n          incids.push(item.id);\n          comments[item.id] = item;\n          if (item.level == 0) {\n            order.push(item.id);\n          }\n          children[item.id] = [];\n          if (item.parent_id !== item.id) {\n            children[item.parent_id].push(item.id);\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      var _iteratorNormalCompletion2 = true;\n      var _didIteratorError2 = false;\n      var _iteratorError2 = undefined;\n\n      try {\n        for (var _iterator2 = order[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n          var _id = _step2.value;\n\n          comments[_id].children = get_children(_id);\n          tree.push(comments[_id]);\n        }\n\n        // Update attributes curcids and newcids.\n      } catch (err) {\n        _didIteratorError2 = true;\n        _iteratorError2 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion2 && _iterator2.return) {\n            _iterator2.return();\n          }\n        } finally {\n          if (_didIteratorError2) {\n            throw _iteratorError2;\n          }\n        }\n      }\n\n      if (incids.length) {\n        if (this.state.cids.length) {\n          var _iteratorNormalCompletion3 = true;\n          var _didIteratorError3 = false;\n          var _iteratorError3 = undefined;\n\n          try {\n            for (var _iterator3 = incids[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n              var id = _step3.value;\n\n              if (this.state.cids.indexOf(id) == -1) newcids.push(id);\n              curcids.push(id);\n            }\n          } catch (err) {\n            _didIteratorError3 = true;\n            _iteratorError3 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion3 && _iterator3.return) {\n                _iterator3.return();\n              }\n            } finally {\n              if (_didIteratorError3) {\n                throw _iteratorError3;\n              }\n            }\n          }\n        } else {\n          curcids = incids;\n          newcids = [];\n        }\n      }\n\n      this.setState({ tree: tree,\n        cids: curcids,\n        newcids: newcids,\n        counter: curcids.length });\n    }\n  }, {\n    key: 'load_comments',\n    value: function load_comments() {\n      _jquery2.default.ajax({\n        url: this.props.list_url,\n        dataType: 'json',\n        cache: false,\n        success: function (data) {\n          // Set here a cookie with the last time comments have been retrieved.\n          // I'll use it to add a label 'new' to every new comment received\n          // after the timestamp stored in the cookie.\n          this.create_tree(data);\n        }.bind(this),\n        error: function (xhr, status, err) {\n          console.error(this.props.list_url, status, err.toString());\n        }.bind(this)\n      });\n    }\n  }, {\n    key: 'load_count',\n    value: function load_count() {\n      _jquery2.default.ajax({\n        url: this.props.count_url,\n        dataType: 'json',\n        cache: false,\n        success: function (data) {\n          this.setState({ counter: data.count });\n        }.bind(this),\n        error: function (xhr, status, err) {\n          console.error(this.props.count_url, status, err.toString());\n        }.bind(this)\n      });\n    }\n  }, {\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.load_comments();\n      if (this.props.polling_interval) setInterval(this.load_count.bind(this), this.props.polling_interval);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var settings = this.props;\n      var comment_counter = this.render_comment_counter();\n      var update_alert = this.render_update_alert();\n      var comment_form = this.render_comment_form();\n\n      var nodes = this.state.tree.map(function (item) {\n        return _react2.default.createElement(_comment.Comment, { key: item.id,\n          data: item,\n          settings: settings,\n          newcids: this.state.newcids,\n          on_comment_created: this.handle_comment_created });\n      }.bind(this));\n\n      return _react2.default.createElement(\n        'div',\n        null,\n        comment_counter,\n        comment_form,\n        _react2.default.createElement('hr', null),\n        update_alert,\n        _react2.default.createElement(\n          'div',\n          { className: 'comment-tree' },\n          _react2.default.createElement(\n            'div',\n            { className: 'media-list' },\n            nodes\n          )\n        )\n      );\n    }\n  }]);\n\n  return CommentBox;\n}(_react2.default.Component);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZGphbmdvX2NvbW1lbnRzX3h0ZC9zdGF0aWMvZGphbmdvX2NvbW1lbnRzX3h0ZC9qcy9zcmMvY29tbWVudGJveC5qc3g/ZjdkMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgJCBmcm9tICdqcXVlcnknO1xuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBSZWFjdERPTSBmcm9tICdyZWFjdC1kb20nO1xuXG5pbXBvcnQgKiBhcyBsaWIgZnJvbSAnLi9saWIuanMnO1xuaW1wb3J0IGRqYW5nbyBmcm9tICdkamFuZ28nO1xuXG5pbXBvcnQge0NvbW1lbnR9IGZyb20gJy4vY29tbWVudC5qc3gnO1xuaW1wb3J0IHtDb21tZW50Rm9ybX0gZnJvbSAnLi9jb21tZW50Zm9ybS5qc3gnO1xuXG5cbmV4cG9ydCBjbGFzcyBDb21tZW50Qm94IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgbGliLmpxdWVyeV9hamF4X3NldHVwKCdjc3JmdG9rZW4nKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgcHJldmlld2luZzogZmFsc2UsXG4gICAgICBwcmV2aWV3OiB7bmFtZTogJycsIGVtYWlsOiAnJywgdXJsOiAnJywgY29tbWVudDogJyd9LFxuICAgICAgdHJlZTogW10sIGNpZHM6IFtdLCBuZXdjaWRzOiBbXSwgY291bnRlcjogdGhpcy5wcm9wcy5jb21tZW50X2NvdW50XG4gICAgfTtcbiAgICB0aGlzLmhhbmRsZV9jb21tZW50X2NyZWF0ZWQgPSB0aGlzLmhhbmRsZV9jb21tZW50X2NyZWF0ZWQuYmluZCh0aGlzKTtcbiAgICB0aGlzLmhhbmRsZV9wcmV2aWV3ID0gdGhpcy5oYW5kbGVfcHJldmlldy5iaW5kKHRoaXMpO1xuICAgIHRoaXMuaGFuZGxlX3VwZGF0ZSA9IHRoaXMuaGFuZGxlX3VwZGF0ZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgaGFuZGxlX2NvbW1lbnRfY3JlYXRlZCgpIHtcbiAgICB0aGlzLmxvYWRfY29tbWVudHMoKTtcbiAgfVxuICBcbiAgaGFuZGxlX3ByZXZpZXcobmFtZSwgZW1haWwsIHVybCwgY29tbWVudCkge1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgcHJldmlldzoge25hbWU6IG5hbWUsIGVtYWlsOiBlbWFpbCwgdXJsOiB1cmwsIGNvbW1lbnQ6IGNvbW1lbnR9LFxuICAgICAgcHJldmlld2luZzogdHJ1ZVxuICAgIH0pO1xuICB9XG5cbiAgaGFuZGxlX3VwZGF0ZShldmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgdGhpcy5sb2FkX2NvbW1lbnRzKCk7XG4gIH1cblxuICByZXNldF9wcmV2aWV3KCkge1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgcHJldmlldzoge25hbWU6ICcnLCBlbWFpbDogJycsIHVybDogJycsIGNvbW1lbnQ6ICcnfSxcbiAgICAgIHByZXZpZXdpbmc6IGZhbHNlXG4gICAgfSk7XG4gIH1cblxuICByZW5kZXJfY29tbWVudF9jb3VudGVyKCkge1xuICAgIGlmICh0aGlzLnN0YXRlLmNvdW50ZXIgPiAwKSB7XG4gICAgICB2YXIgZm10cyA9IGRqYW5nby5uZ2V0dGV4dChcIk9uZSBjb21tZW50LlwiLCBcIiVzIGNvbW1lbnRzLlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5jaWRzLmxlbmd0aCk7XG4gICAgICB2YXIgdGV4dCA9IGRqYW5nby5pbnRlcnBvbGF0ZShmbXRzLCBbdGhpcy5zdGF0ZS5jaWRzLmxlbmd0aF0pO1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgPGRpdj5cbiAgICAgICAgICA8aDUgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXJcIj57dGV4dH08L2g1PlxuICAgICAgICAgIDxoci8+XG4gICAgICAgIDwvZGl2PlxuICAgICAgKTtcbiAgICB9IGVsc2VcbiAgICAgIHJldHVybiBcIlwiO1xuICB9XG5cbiAgcmVuZGVyX2NvbW1lbnRfZm9ybSgpIHtcbiAgICBpZih0aGlzLnByb3BzLmFsbG93X2NvbW1lbnRzKSB7XG4gICAgICByZXR1cm4gKFxuICAgICAgICA8Q29tbWVudEZvcm0gZm9ybT17dGhpcy5wcm9wcy5mb3JtfVxuICAgICAgICAgICAgICAgICAgICAgc2VuZF91cmw9e3RoaXMucHJvcHMuc2VuZF91cmx9XG4gICAgICAgICAgICAgICAgICAgICBjdXJyZW50X3VzZXI9e3RoaXMucHJvcHMuY3VycmVudF91c2VyfVxuICAgICAgICAgICAgICAgICAgICAgaXNfYXV0aGVudGljYXRlZD17dGhpcy5wcm9wcy5pc19hdXRoZW50aWNhdGVkfVxuICAgICAgICAgICAgICAgICAgICAgb25fY29tbWVudF9jcmVhdGVkPXt0aGlzLmhhbmRsZV9jb21tZW50X2NyZWF0ZWR9IC8+XG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gKFxuICAgICAgICA8aDU+Q29tbWVudHMgYXJlIGRpc2FibGVkIGZvciB0aGlzIGFydGljbGUuPC9oNT5cbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgcmVuZGVyX3VwZGF0ZV9hbGVydCgpIHtcbiAgICB2YXIgZGlmZiA9IHRoaXMuc3RhdGUuY291bnRlciAtIHRoaXMuc3RhdGUuY2lkcy5sZW5ndGg7XG4gICAgaWYgKGRpZmYgPiAwKSB7XG4gICAgICB2YXIgZm10cyA9IGRqYW5nby5uZ2V0dGV4dChcIlRoZXJlIGlzIGEgbmV3IGNvbW1lbnQuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlRoZXJlIGFyZSAlcyBuZXcgY29tbWVudHMuXCIsIGRpZmYpO1xuICAgICAgdmFyIG1lc3NhZ2UgPSBkamFuZ28uaW50ZXJwb2xhdGUoZm10cywgW2RpZmZdKTtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxlcnQgYWxlcnQtaW5mb1wiPlxuICAgICAgICAgIHttZXNzYWdlfVxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicHVsbC1yaWdodFwiPlxuICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3NOYW1lPVwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi14c1wiXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuaGFuZGxlX3VwZGF0ZX0+dXBkYXRlPC9idXR0b24+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgKTtcbiAgICB9IGVsc2VcbiAgICAgIHJldHVybiBcIlwiO1xuICB9XG5cbiAgY3JlYXRlX3RyZWUoZGF0YSkge1xuICAgIHZhciB0cmVlID0gbmV3IEFycmF5KCk7XG4gICAgdmFyIG9yZGVyID0gbmV3IEFycmF5KCk7XG4gICAgdmFyIGNvbW1lbnRzID0ge307XG4gICAgdmFyIGNoaWxkcmVuID0ge307XG4gICAgdmFyIGluY2lkcyA9IFtdLCBjdXJjaWRzID0gW10sIG5ld2NpZHMgPSBbXTtcblxuICAgIGZ1bmN0aW9uIGdldF9jaGlsZHJlbihjaWQpIHtcbiAgICAgIHJldHVybiBjaGlsZHJlbltjaWRdLm1hcChmdW5jdGlvbihpbmRleCkge1xuICAgICAgICBpZihjb21tZW50c1tpbmRleF0uY2hpbGRyZW4gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgY29tbWVudHNbaW5kZXhdLmNoaWxkcmVuID0gZ2V0X2NoaWxkcmVuKGluZGV4KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29tbWVudHNbaW5kZXhdO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICBcbiAgICBmb3IgKGxldCBpdGVtIG9mIGRhdGEpIHtcbiAgICAgIGluY2lkcy5wdXNoKGl0ZW0uaWQpO1xuICAgICAgY29tbWVudHNbaXRlbS5pZF0gPSBpdGVtO1xuICAgICAgaWYgKGl0ZW0ubGV2ZWwgPT0gMCkge1xuICAgICAgICBvcmRlci5wdXNoKGl0ZW0uaWQpO1xuICAgICAgfVxuICAgICAgY2hpbGRyZW5baXRlbS5pZF0gPSBbXTtcbiAgICAgIGlmIChpdGVtLnBhcmVudF9pZCE9PWl0ZW0uaWQpIHtcbiAgICAgICAgY2hpbGRyZW5baXRlbS5wYXJlbnRfaWRdLnB1c2goaXRlbS5pZCk7XG4gICAgICB9XG4gICAgfVxuICAgIGZvciAobGV0IGlkIG9mIG9yZGVyKSB7XG4gICAgICBjb21tZW50c1tpZF0uY2hpbGRyZW4gPSBnZXRfY2hpbGRyZW4oaWQpO1xuICAgICAgdHJlZS5wdXNoKGNvbW1lbnRzW2lkXSk7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIGF0dHJpYnV0ZXMgY3VyY2lkcyBhbmQgbmV3Y2lkcy5cbiAgICBpZiAoaW5jaWRzLmxlbmd0aCkge1xuICAgICAgaWYgKHRoaXMuc3RhdGUuY2lkcy5sZW5ndGgpIHtcbiAgICAgICAgZm9yIChsZXQgaWQgb2YgaW5jaWRzKSB7XG4gICAgICAgICAgaWYgKHRoaXMuc3RhdGUuY2lkcy5pbmRleE9mKGlkKSA9PSAtMSlcbiAgICAgICAgICAgIG5ld2NpZHMucHVzaChpZCk7XG4gICAgICAgICAgY3VyY2lkcy5wdXNoKGlkKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY3VyY2lkcyA9IGluY2lkcztcbiAgICAgICAgbmV3Y2lkcyA9IFtdO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuc2V0U3RhdGUoe3RyZWU6dHJlZSxcbiAgICAgICAgICAgICAgICAgICBjaWRzOiBjdXJjaWRzLFxuICAgICAgICAgICAgICAgICAgIG5ld2NpZHM6IG5ld2NpZHMsXG4gICAgICAgICAgICAgICAgICAgY291bnRlcjogY3VyY2lkcy5sZW5ndGh9KTtcbiAgfVxuXG4gIGxvYWRfY29tbWVudHMoKSB7XG4gICAgJC5hamF4KHtcbiAgICAgIHVybDogdGhpcy5wcm9wcy5saXN0X3VybCxcbiAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICBjYWNoZTogZmFsc2UsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIC8vIFNldCBoZXJlIGEgY29va2llIHdpdGggdGhlIGxhc3QgdGltZSBjb21tZW50cyBoYXZlIGJlZW4gcmV0cmlldmVkLlxuICAgICAgICAvLyBJJ2xsIHVzZSBpdCB0byBhZGQgYSBsYWJlbCAnbmV3JyB0byBldmVyeSBuZXcgY29tbWVudCByZWNlaXZlZFxuICAgICAgICAvLyBhZnRlciB0aGUgdGltZXN0YW1wIHN0b3JlZCBpbiB0aGUgY29va2llLlxuICAgICAgICB0aGlzLmNyZWF0ZV90cmVlKGRhdGEpO1xuICAgICAgfS5iaW5kKHRoaXMpLFxuICAgICAgZXJyb3I6IGZ1bmN0aW9uKHhociwgc3RhdHVzLCBlcnIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcih0aGlzLnByb3BzLmxpc3RfdXJsLCBzdGF0dXMsIGVyci50b1N0cmluZygpKTtcbiAgICAgIH0uYmluZCh0aGlzKVxuICAgIH0pO1xuICB9XG5cbiAgbG9hZF9jb3VudCgpIHtcbiAgICAkLmFqYXgoe1xuICAgICAgdXJsOiB0aGlzLnByb3BzLmNvdW50X3VybCxcbiAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICBjYWNoZTogZmFsc2UsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe2NvdW50ZXI6IGRhdGEuY291bnR9KTtcbiAgICAgIH0uYmluZCh0aGlzKSxcbiAgICAgIGVycm9yOiBmdW5jdGlvbih4aHIsIHN0YXR1cywgZXJyKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IodGhpcy5wcm9wcy5jb3VudF91cmwsIHN0YXR1cywgZXJyLnRvU3RyaW5nKCkpO1xuICAgICAgfS5iaW5kKHRoaXMpXG4gICAgfSk7XG4gIH1cbiAgXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIHRoaXMubG9hZF9jb21tZW50cygpO1xuICAgIGlmKHRoaXMucHJvcHMucG9sbGluZ19pbnRlcnZhbClcbiAgICAgIHNldEludGVydmFsKHRoaXMubG9hZF9jb3VudC5iaW5kKHRoaXMpLCB0aGlzLnByb3BzLnBvbGxpbmdfaW50ZXJ2YWwpO1xuICB9XG4gIFxuICByZW5kZXIoKSB7XG4gICAgdmFyIHNldHRpbmdzID0gdGhpcy5wcm9wcztcbiAgICB2YXIgY29tbWVudF9jb3VudGVyID0gdGhpcy5yZW5kZXJfY29tbWVudF9jb3VudGVyKCk7XG4gICAgdmFyIHVwZGF0ZV9hbGVydCA9IHRoaXMucmVuZGVyX3VwZGF0ZV9hbGVydCgpO1xuICAgIHZhciBjb21tZW50X2Zvcm0gPSB0aGlzLnJlbmRlcl9jb21tZW50X2Zvcm0oKTtcblxuICAgIHZhciBub2RlcyA9IHRoaXMuc3RhdGUudHJlZS5tYXAoZnVuY3Rpb24oaXRlbSkge1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgPENvbW1lbnQga2V5PXtpdGVtLmlkfVxuICAgICAgICAgICAgICAgICBkYXRhPXtpdGVtfVxuICAgICAgICAgICAgICAgICBzZXR0aW5ncz17c2V0dGluZ3N9XG4gICAgICAgICAgICAgICAgIG5ld2NpZHM9e3RoaXMuc3RhdGUubmV3Y2lkc31cbiAgICAgICAgICAgICAgICAgb25fY29tbWVudF9jcmVhdGVkPXt0aGlzLmhhbmRsZV9jb21tZW50X2NyZWF0ZWR9IC8+XG4gICAgICApO1xuICAgIH0uYmluZCh0aGlzKSk7XG4gICAgXG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXY+XG4gICAgICAgIHtjb21tZW50X2NvdW50ZXJ9XG4gICAgICAgIHtjb21tZW50X2Zvcm19XG4gICAgICAgIDxoci8+XG4gICAgICAgIHt1cGRhdGVfYWxlcnR9XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29tbWVudC10cmVlXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtZWRpYS1saXN0XCI+XG4gICAgICAgICAgICB7bm9kZXN9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGRqYW5nb19jb21tZW50c194dGQvc3RhdGljL2RqYW5nb19jb21tZW50c194dGQvanMvc3JjL2NvbW1lbnRib3guanN4Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7QUFBQTtBQUNBOzs7Ozs7Ozs7OztBQUVBOzs7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBVkE7QUFXQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTs7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFGQTtBQUtBO0FBRUE7OztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBREE7QUFGQTtBQVFBO0FBRUE7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWZBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFnQkE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUExQkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQTJCQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBaENBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQWdDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUxBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWkE7QUFjQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRBO0FBV0E7OztBQUVBO0FBQ0E7QUFDQTtBQUVBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBREE7QUFMQTtBQVlBOzs7O0FBN01BIiwic291cmNlUm9vdCI6IiJ9");

/***/ })

},[101]);